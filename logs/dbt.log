[0m16:06:31.620827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B612D8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B63360EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B63360D00>]}


============================== 16:06:31.622835 | 40935f3e-0a84-439c-8ff4-3b5dca6cc754 ==============================
[0m16:06:31.622835 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:06:31.623836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\krisha_data_pipeline', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\krisha_data_pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:06:31.766334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40935f3e-0a84-439c-8ff4-3b5dca6cc754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B5F8F6F10>]}
[0m16:06:31.809394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40935f3e-0a84-439c-8ff4-3b5dca6cc754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B633219A0>]}
[0m16:06:31.810395 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:06:31.964059 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:06:31.965064 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:06:31.965992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '40935f3e-0a84-439c-8ff4-3b5dca6cc754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B6333B790>]}
[0m16:06:32.924687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40935f3e-0a84-439c-8ff4-3b5dca6cc754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B63B55130>]}
[0m16:06:32.993676 [debug] [MainThread]: Wrote artifact WritableManifest to C:\krisha_data_pipeline\target\manifest.json
[0m16:06:32.997669 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\krisha_data_pipeline\target\semantic_manifest.json
[0m16:06:33.009811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40935f3e-0a84-439c-8ff4-3b5dca6cc754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B63B6E310>]}
[0m16:06:33.009811 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m16:06:33.010804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40935f3e-0a84-439c-8ff4-3b5dca6cc754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B64BA1C70>]}
[0m16:06:33.011805 [info ] [MainThread]: 
[0m16:06:33.011805 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:06:33.012805 [info ] [MainThread]: 
[0m16:06:33.013805 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:06:33.018809 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m16:06:33.067932 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m16:06:33.068928 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m16:06:33.068928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:33.098296 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.029 seconds
[0m16:06:33.099360 [debug] [ThreadPool]: On list_krisha_data: Close
[0m16:06:33.100364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_krisha_data, now create_krisha_data_public_public)
[0m16:06:33.101297 [debug] [ThreadPool]: Creating schema "database: "krisha_data"
schema: "public_public"
"
[0m16:06:33.105359 [debug] [ThreadPool]: Using postgres connection "create_krisha_data_public_public"
[0m16:06:33.106363 [debug] [ThreadPool]: On create_krisha_data_public_public: BEGIN
[0m16:06:33.106363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:33.134334 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m16:06:33.134334 [debug] [ThreadPool]: Using postgres connection "create_krisha_data_public_public"
[0m16:06:33.135339 [debug] [ThreadPool]: On create_krisha_data_public_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "create_krisha_data_public_public"} */
create schema if not exists "public_public"
[0m16:06:33.136333 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m16:06:33.137333 [debug] [ThreadPool]: On create_krisha_data_public_public: COMMIT
[0m16:06:33.138340 [debug] [ThreadPool]: Using postgres connection "create_krisha_data_public_public"
[0m16:06:33.138340 [debug] [ThreadPool]: On create_krisha_data_public_public: COMMIT
[0m16:06:33.139333 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m16:06:33.139333 [debug] [ThreadPool]: On create_krisha_data_public_public: Close
[0m16:06:33.140343 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public_public'
[0m16:06:33.145657 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public_public"
[0m16:06:33.146657 [debug] [ThreadPool]: On list_krisha_data_public_public: BEGIN
[0m16:06:33.146657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:33.181211 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m16:06:33.181211 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public_public"
[0m16:06:33.182281 [debug] [ThreadPool]: On list_krisha_data_public_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m16:06:33.184210 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m16:06:33.185278 [debug] [ThreadPool]: On list_krisha_data_public_public: ROLLBACK
[0m16:06:33.186278 [debug] [ThreadPool]: On list_krisha_data_public_public: Close
[0m16:06:33.189664 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:33.190725 [debug] [MainThread]: On master: BEGIN
[0m16:06:33.190725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:33.217416 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m16:06:33.217416 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:33.218486 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:06:33.221725 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m16:06:33.222730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40935f3e-0a84-439c-8ff4-3b5dca6cc754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B64C75E80>]}
[0m16:06:33.223730 [debug] [MainThread]: On master: ROLLBACK
[0m16:06:33.223730 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:33.224729 [debug] [MainThread]: On master: BEGIN
[0m16:06:33.224729 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:06:33.225729 [debug] [MainThread]: On master: COMMIT
[0m16:06:33.225729 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:33.225729 [debug] [MainThread]: On master: COMMIT
[0m16:06:33.226730 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:06:33.226730 [debug] [MainThread]: On master: Close
[0m16:06:33.229729 [debug] [Thread-1  ]: Began running node model.krisha_data_pipeline.raw_data
[0m16:06:33.230739 [info ] [Thread-1  ]: 1 of 3 START sql table model public_public.raw_data ............................ [RUN]
[0m16:06:33.231732 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m16:06:33.231732 [debug] [Thread-1  ]: Began compiling node model.krisha_data_pipeline.raw_data
[0m16:06:33.238830 [debug] [Thread-1  ]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m16:06:33.239829 [debug] [Thread-1  ]: Began executing node model.krisha_data_pipeline.raw_data
[0m16:06:33.269946 [debug] [Thread-1  ]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m16:06:33.272943 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:06:33.272943 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m16:06:33.273942 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:06:33.305514 [debug] [Thread-1  ]: SQL status: BEGIN in 0.032 seconds
[0m16:06:33.306515 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:06:33.306515 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public_public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    

-- просто читаем данные из Postgres
select *
from "your_db_name"."public"."raw_flats"
  );
  
[0m16:06:33.308508 [debug] [Thread-1  ]: Postgres adapter: Postgres error: ОШИБКА:  ссылки между базами не реализованы: "your_db_name.public.raw_flats"
LINE 16: from "your_db_name"."public"."raw_flats"
              ^

[0m16:06:33.309514 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: ROLLBACK
[0m16:06:33.309514 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: Close
[0m16:06:33.312515 [debug] [Thread-1  ]: Database Error in model raw_data (models\raw_data.sql)
  ОШИБКА:  ссылки между базами не реализованы: "your_db_name.public.raw_flats"
  LINE 16: from "your_db_name"."public"."raw_flats"
                ^
  compiled code at target\run\krisha_data_pipeline\models\raw_data.sql
[0m16:06:33.314512 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40935f3e-0a84-439c-8ff4-3b5dca6cc754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B650E0C40>]}
[0m16:06:33.314512 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model public_public.raw_data ................... [[31mERROR[0m in 0.08s]
[0m16:06:33.315508 [debug] [Thread-1  ]: Finished running node model.krisha_data_pipeline.raw_data
[0m16:06:33.316525 [debug] [Thread-7  ]: Marking all children of 'model.krisha_data_pipeline.raw_data' to be skipped because of status 'error'.  Reason: Database Error in model raw_data (models\raw_data.sql)
  ОШИБКА:  ссылки между базами не реализованы: "your_db_name.public.raw_flats"
  LINE 16: from "your_db_name"."public"."raw_flats"
                ^
  compiled code at target\run\krisha_data_pipeline\models\raw_data.sql.
[0m16:06:33.317538 [debug] [Thread-3  ]: Began running node model.krisha_data_pipeline.transform_data
[0m16:06:33.317538 [info ] [Thread-3  ]: 2 of 3 SKIP relation public_public.transform_data .............................. [[33mSKIP[0m]
[0m16:06:33.318550 [debug] [Thread-3  ]: Finished running node model.krisha_data_pipeline.transform_data
[0m16:06:33.318550 [debug] [Thread-2  ]: Began running node model.krisha_data_pipeline.final_model
[0m16:06:33.319539 [info ] [Thread-2  ]: 3 of 3 SKIP relation public_public.final_model ................................. [[33mSKIP[0m]
[0m16:06:33.319539 [debug] [Thread-2  ]: Finished running node model.krisha_data_pipeline.final_model
[0m16:06:33.321549 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:33.321549 [debug] [MainThread]: On master: BEGIN
[0m16:06:33.321549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:06:33.351027 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m16:06:33.352040 [debug] [MainThread]: On master: COMMIT
[0m16:06:33.352040 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:33.353039 [debug] [MainThread]: On master: COMMIT
[0m16:06:33.353039 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:06:33.354037 [debug] [MainThread]: On master: Close
[0m16:06:33.354037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:33.355027 [debug] [MainThread]: Connection 'create_krisha_data_public_public' was properly closed.
[0m16:06:33.355027 [debug] [MainThread]: Connection 'list_krisha_data_public_public' was properly closed.
[0m16:06:33.355027 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.raw_data' was properly closed.
[0m16:06:33.356027 [info ] [MainThread]: 
[0m16:06:33.356027 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m16:06:33.357026 [debug] [MainThread]: Command end result
[0m16:06:33.375627 [debug] [MainThread]: Wrote artifact WritableManifest to C:\krisha_data_pipeline\target\manifest.json
[0m16:06:33.377701 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\krisha_data_pipeline\target\semantic_manifest.json
[0m16:06:33.382712 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\krisha_data_pipeline\target\run_results.json
[0m16:06:33.383707 [info ] [MainThread]: 
[0m16:06:33.383707 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:06:33.384720 [info ] [MainThread]: 
[0m16:06:33.385701 [error] [MainThread]:   Database Error in model raw_data (models\raw_data.sql)
  ОШИБКА:  ссылки между базами не реализованы: "your_db_name.public.raw_flats"
  LINE 16: from "your_db_name"."public"."raw_flats"
                ^
  compiled code at target\run\krisha_data_pipeline\models\raw_data.sql
[0m16:06:33.385701 [info ] [MainThread]: 
[0m16:06:33.386713 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m16:06:33.387701 [debug] [MainThread]: Command `dbt run` failed at 16:06:33.387701 after 1.82 seconds
[0m16:06:33.387701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B612D8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B633219A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B615F59D0>]}
[0m16:06:33.388702 [debug] [MainThread]: Flushing usage events
[0m16:06:34.268398 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:49.558609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216AC018520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216AE092BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216AE092EB0>]}


============================== 16:09:49.561609 | b49629d0-cc3d-4160-a67f-7fa53c9f1576 ==============================
[0m16:09:49.561609 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:09:49.562114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\krisha_data_pipeline', 'log_path': 'C:\\krisha_data_pipeline\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:09:49.717408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b49629d0-cc3d-4160-a67f-7fa53c9f1576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216AE198340>]}
[0m16:09:49.761529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b49629d0-cc3d-4160-a67f-7fa53c9f1576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216ADEF3160>]}
[0m16:09:49.762529 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:09:49.922007 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:09:50.037311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:09:50.038312 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\schema.yml
[0m16:09:50.429507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b49629d0-cc3d-4160-a67f-7fa53c9f1576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216AAFAC070>]}
[0m16:09:50.498435 [debug] [MainThread]: Wrote artifact WritableManifest to C:\krisha_data_pipeline\target\manifest.json
[0m16:09:50.502449 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\krisha_data_pipeline\target\semantic_manifest.json
[0m16:09:50.517672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b49629d0-cc3d-4160-a67f-7fa53c9f1576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216AE1F7AC0>]}
[0m16:09:50.518614 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m16:09:50.519280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b49629d0-cc3d-4160-a67f-7fa53c9f1576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216AE1EEB80>]}
[0m16:09:50.520640 [info ] [MainThread]: 
[0m16:09:50.521843 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:09:50.523191 [info ] [MainThread]: 
[0m16:09:50.523982 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:09:50.529053 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m16:09:50.591257 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m16:09:50.592259 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m16:09:50.592809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:50.628390 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.035 seconds
[0m16:09:50.630401 [debug] [ThreadPool]: On list_krisha_data: Close
[0m16:09:50.632685 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public_public'
[0m16:09:50.639687 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public_public"
[0m16:09:50.640197 [debug] [ThreadPool]: On list_krisha_data_public_public: BEGIN
[0m16:09:50.640686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:50.675488 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m16:09:50.676477 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public_public"
[0m16:09:50.676477 [debug] [ThreadPool]: On list_krisha_data_public_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m16:09:50.680817 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m16:09:50.683445 [debug] [ThreadPool]: On list_krisha_data_public_public: ROLLBACK
[0m16:09:50.683445 [debug] [ThreadPool]: On list_krisha_data_public_public: Close
[0m16:09:50.689445 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:50.690448 [debug] [MainThread]: On master: BEGIN
[0m16:09:50.690448 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:50.722749 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m16:09:50.723741 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:50.723741 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:50.727867 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m16:09:50.728874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b49629d0-cc3d-4160-a67f-7fa53c9f1576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216AFC0EC10>]}
[0m16:09:50.729874 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:50.730865 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:50.731575 [debug] [MainThread]: On master: BEGIN
[0m16:09:50.731643 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:09:50.731643 [debug] [MainThread]: On master: COMMIT
[0m16:09:50.732649 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:50.732649 [debug] [MainThread]: On master: COMMIT
[0m16:09:50.733649 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:09:50.733649 [debug] [MainThread]: On master: Close
[0m16:09:50.737108 [debug] [Thread-1  ]: Began running node model.krisha_data_pipeline.raw_data
[0m16:09:50.738115 [info ] [Thread-1  ]: 1 of 3 START sql table model public_public.raw_data ............................ [RUN]
[0m16:09:50.738780 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m16:09:50.738780 [debug] [Thread-1  ]: Began compiling node model.krisha_data_pipeline.raw_data
[0m16:09:50.747064 [debug] [Thread-1  ]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m16:09:50.748070 [debug] [Thread-1  ]: Began executing node model.krisha_data_pipeline.raw_data
[0m16:09:50.789212 [debug] [Thread-1  ]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m16:09:50.790220 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:09:50.791210 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m16:09:50.791210 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:09:50.821563 [debug] [Thread-1  ]: SQL status: BEGIN in 0.030 seconds
[0m16:09:50.821563 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:09:50.822554 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public_public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    

-- просто читаем данные из Postgres
select *
from "krisha_data"."public"."raw_flats"
  );
  
[0m16:09:50.826560 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m16:09:50.834560 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:09:50.835560 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public_public"."raw_data__dbt_tmp" rename to "raw_data"
[0m16:09:50.835560 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:09:50.847553 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m16:09:50.847553 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:09:50.848553 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m16:09:50.848553 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m16:09:50.854718 [debug] [Thread-1  ]: Applying DROP to: "krisha_data"."public_public"."raw_data__dbt_backup"
[0m16:09:50.859717 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:09:50.860719 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public_public"."raw_data__dbt_backup" cascade
[0m16:09:50.861723 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m16:09:50.864710 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: Close
[0m16:09:50.866819 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b49629d0-cc3d-4160-a67f-7fa53c9f1576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216AA5F0D30>]}
[0m16:09:50.867825 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public_public.raw_data ....................... [[32mSELECT 0[0m in 0.13s]
[0m16:09:50.868813 [debug] [Thread-1  ]: Finished running node model.krisha_data_pipeline.raw_data
[0m16:09:50.868813 [debug] [Thread-3  ]: Began running node model.krisha_data_pipeline.transform_data
[0m16:09:50.869822 [info ] [Thread-3  ]: 2 of 3 START sql table model public_public.transform_data ...................... [RUN]
[0m16:09:50.870813 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.krisha_data_pipeline.transform_data'
[0m16:09:50.870813 [debug] [Thread-3  ]: Began compiling node model.krisha_data_pipeline.transform_data
[0m16:09:50.873813 [debug] [Thread-3  ]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m16:09:50.874819 [debug] [Thread-3  ]: Began executing node model.krisha_data_pipeline.transform_data
[0m16:09:50.877819 [debug] [Thread-3  ]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m16:09:50.878820 [debug] [Thread-3  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m16:09:50.879820 [debug] [Thread-3  ]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m16:09:50.879969 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:09:50.909932 [debug] [Thread-3  ]: SQL status: BEGIN in 0.030 seconds
[0m16:09:50.909932 [debug] [Thread-3  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m16:09:50.910930 [debug] [Thread-3  ]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public_public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    

select
  *
from "krisha_data"."public_public"."raw_data"
where price is not null
  );
  
[0m16:09:50.914919 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.004 seconds
[0m16:09:50.918997 [debug] [Thread-3  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m16:09:50.918997 [debug] [Thread-3  ]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public_public"."transform_data__dbt_tmp" rename to "transform_data"
[0m16:09:50.919996 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:09:50.920946 [debug] [Thread-3  ]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m16:09:50.921997 [debug] [Thread-3  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m16:09:50.921997 [debug] [Thread-3  ]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m16:09:50.922923 [debug] [Thread-3  ]: SQL status: COMMIT in 0.000 seconds
[0m16:09:50.924998 [debug] [Thread-3  ]: Applying DROP to: "krisha_data"."public_public"."transform_data__dbt_backup"
[0m16:09:50.926016 [debug] [Thread-3  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m16:09:50.926016 [debug] [Thread-3  ]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
drop table if exists "krisha_data"."public_public"."transform_data__dbt_backup" cascade
[0m16:09:50.926923 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.000 seconds
[0m16:09:50.928041 [debug] [Thread-3  ]: On model.krisha_data_pipeline.transform_data: Close
[0m16:09:50.929089 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b49629d0-cc3d-4160-a67f-7fa53c9f1576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216AFC50580>]}
[0m16:09:50.929901 [info ] [Thread-3  ]: 2 of 3 OK created sql table model public_public.transform_data ................. [[32mSELECT 0[0m in 0.06s]
[0m16:09:50.930667 [debug] [Thread-3  ]: Finished running node model.krisha_data_pipeline.transform_data
[0m16:09:50.930667 [debug] [Thread-2  ]: Began running node model.krisha_data_pipeline.final_model
[0m16:09:50.931688 [info ] [Thread-2  ]: 3 of 3 START sql table model public_public.final_model ......................... [RUN]
[0m16:09:50.932702 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.krisha_data_pipeline.final_model'
[0m16:09:50.932702 [debug] [Thread-2  ]: Began compiling node model.krisha_data_pipeline.final_model
[0m16:09:50.935750 [debug] [Thread-2  ]: Writing injected SQL for node "model.krisha_data_pipeline.final_model"
[0m16:09:50.936752 [debug] [Thread-2  ]: Began executing node model.krisha_data_pipeline.final_model
[0m16:09:50.939747 [debug] [Thread-2  ]: Writing runtime sql for node "model.krisha_data_pipeline.final_model"
[0m16:09:50.939747 [debug] [Thread-2  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m16:09:50.940758 [debug] [Thread-2  ]: On model.krisha_data_pipeline.final_model: BEGIN
[0m16:09:50.940758 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:09:50.971611 [debug] [Thread-2  ]: SQL status: BEGIN in 0.030 seconds
[0m16:09:50.971611 [debug] [Thread-2  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m16:09:50.972680 [debug] [Thread-2  ]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */

  
    

  create  table "krisha_data"."public_public"."final_model__dbt_tmp"
  
  
    as
  
  (
    

select
  name,
  rooms,
  sqm,
  price,
  city,
  date,
  year_of_est
from "krisha_data"."public_public"."transform_data"
order by price desc
  );
  
[0m16:09:50.976777 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.004 seconds
[0m16:09:50.980865 [debug] [Thread-2  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m16:09:50.980865 [debug] [Thread-2  ]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
alter table "krisha_data"."public_public"."final_model__dbt_tmp" rename to "final_model"
[0m16:09:50.981840 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:09:50.982866 [debug] [Thread-2  ]: On model.krisha_data_pipeline.final_model: COMMIT
[0m16:09:50.983864 [debug] [Thread-2  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m16:09:50.983864 [debug] [Thread-2  ]: On model.krisha_data_pipeline.final_model: COMMIT
[0m16:09:50.984987 [debug] [Thread-2  ]: SQL status: COMMIT in 0.000 seconds
[0m16:09:50.987054 [debug] [Thread-2  ]: Applying DROP to: "krisha_data"."public_public"."final_model__dbt_backup"
[0m16:09:50.988057 [debug] [Thread-2  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m16:09:50.988057 [debug] [Thread-2  ]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
drop table if exists "krisha_data"."public_public"."final_model__dbt_backup" cascade
[0m16:09:50.988993 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.000 seconds
[0m16:09:50.990100 [debug] [Thread-2  ]: On model.krisha_data_pipeline.final_model: Close
[0m16:09:50.990100 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b49629d0-cc3d-4160-a67f-7fa53c9f1576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216AC3870A0>]}
[0m16:09:50.991401 [info ] [Thread-2  ]: 3 of 3 OK created sql table model public_public.final_model .................... [[32mSELECT 0[0m in 0.06s]
[0m16:09:50.992060 [debug] [Thread-2  ]: Finished running node model.krisha_data_pipeline.final_model
[0m16:09:50.993479 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:50.993479 [debug] [MainThread]: On master: BEGIN
[0m16:09:50.993479 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:51.020943 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m16:09:51.021924 [debug] [MainThread]: On master: COMMIT
[0m16:09:51.021924 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:51.021924 [debug] [MainThread]: On master: COMMIT
[0m16:09:51.022971 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:09:51.022971 [debug] [MainThread]: On master: Close
[0m16:09:51.023972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:51.023972 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m16:09:51.024972 [debug] [MainThread]: Connection 'list_krisha_data_public_public' was properly closed.
[0m16:09:51.025216 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.raw_data' was properly closed.
[0m16:09:51.025750 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.transform_data' was properly closed.
[0m16:09:51.025750 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.final_model' was properly closed.
[0m16:09:51.025750 [info ] [MainThread]: 
[0m16:09:51.026797 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m16:09:51.027796 [debug] [MainThread]: Command end result
[0m16:09:51.043794 [debug] [MainThread]: Wrote artifact WritableManifest to C:\krisha_data_pipeline\target\manifest.json
[0m16:09:51.045795 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\krisha_data_pipeline\target\semantic_manifest.json
[0m16:09:51.051794 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\krisha_data_pipeline\target\run_results.json
[0m16:09:51.052806 [info ] [MainThread]: 
[0m16:09:51.053884 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:51.054385 [info ] [MainThread]: 
[0m16:09:51.055108 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:09:51.056158 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:51.056158 after 1.55 seconds
[0m16:09:51.056158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216AC018520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216ABA1B790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216AE054520>]}
[0m16:09:51.057158 [debug] [MainThread]: Flushing usage events
[0m16:09:51.897173 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:15:26.251454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179743884C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017976410FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017976410DF0>]}


============================== 16:15:26.254503 | 00262d86-cdbc-4885-8125-e902cf04c661 ==============================
[0m16:15:26.254503 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:15:26.255845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\krisha_data_pipeline\\logs', 'profiles_dir': 'C:\\krisha_data_pipeline', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:15:26.398192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00262d86-cdbc-4885-8125-e902cf04c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179763EC9D0>]}
[0m16:15:26.449547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00262d86-cdbc-4885-8125-e902cf04c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179763E39A0>]}
[0m16:15:26.450547 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:15:26.608012 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:15:26.686213 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:15:26.686213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '00262d86-cdbc-4885-8125-e902cf04c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017975D74640>]}
[0m16:15:27.603811 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.krisha_data_pipeline.marts.final_model
[0m16:15:27.613887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00262d86-cdbc-4885-8125-e902cf04c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017976C91130>]}
[0m16:15:27.676987 [debug] [MainThread]: Wrote artifact WritableManifest to C:\krisha_data_pipeline\target\manifest.json
[0m16:15:27.681055 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\krisha_data_pipeline\target\semantic_manifest.json
[0m16:15:27.694148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00262d86-cdbc-4885-8125-e902cf04c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017977C87FA0>]}
[0m16:15:27.694148 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m16:15:27.695594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00262d86-cdbc-4885-8125-e902cf04c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017977C874F0>]}
[0m16:15:27.696756 [info ] [MainThread]: 
[0m16:15:27.697684 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:15:27.697684 [info ] [MainThread]: 
[0m16:15:27.698839 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:15:27.703256 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m16:15:27.753160 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m16:15:27.754163 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m16:15:27.754163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:27.783071 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m16:15:27.784065 [debug] [ThreadPool]: On list_krisha_data: Close
[0m16:15:27.786065 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public_public'
[0m16:15:27.791206 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public_public"
[0m16:15:27.791206 [debug] [ThreadPool]: On list_krisha_data_public_public: BEGIN
[0m16:15:27.792065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:27.817073 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m16:15:27.818065 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public_public"
[0m16:15:27.818065 [debug] [ThreadPool]: On list_krisha_data_public_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m16:15:27.821074 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m16:15:27.822066 [debug] [ThreadPool]: On list_krisha_data_public_public: ROLLBACK
[0m16:15:27.822066 [debug] [ThreadPool]: On list_krisha_data_public_public: Close
[0m16:15:27.826911 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:27.827909 [debug] [MainThread]: On master: BEGIN
[0m16:15:27.827909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:27.854011 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m16:15:27.854011 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:27.855088 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:15:27.859069 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m16:15:27.860079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00262d86-cdbc-4885-8125-e902cf04c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001797325BB80>]}
[0m16:15:27.860079 [debug] [MainThread]: On master: ROLLBACK
[0m16:15:27.861076 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:27.861076 [debug] [MainThread]: On master: BEGIN
[0m16:15:27.862068 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:15:27.862068 [debug] [MainThread]: On master: COMMIT
[0m16:15:27.862068 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:27.863069 [debug] [MainThread]: On master: COMMIT
[0m16:15:27.863069 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:15:27.863615 [debug] [MainThread]: On master: Close
[0m16:15:27.866630 [debug] [Thread-1  ]: Began running node model.krisha_data_pipeline.raw_data
[0m16:15:27.866630 [info ] [Thread-1  ]: 1 of 3 START sql table model public_public.raw_data ............................ [RUN]
[0m16:15:27.868146 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m16:15:27.868146 [debug] [Thread-1  ]: Began compiling node model.krisha_data_pipeline.raw_data
[0m16:15:27.875156 [debug] [Thread-1  ]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m16:15:27.876156 [debug] [Thread-1  ]: Began executing node model.krisha_data_pipeline.raw_data
[0m16:15:27.951527 [debug] [Thread-1  ]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m16:15:27.952528 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:15:27.952528 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m16:15:27.953520 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:15:27.978564 [debug] [Thread-1  ]: SQL status: BEGIN in 0.025 seconds
[0m16:15:27.979558 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:15:27.979558 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public_public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    

-- просто читаем данные из Postgres
select *
from "krisha_data"."public"."raw_flats"
  );
  
[0m16:15:27.982911 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m16:15:27.990905 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:15:27.990905 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public_public"."raw_data" rename to "raw_data__dbt_backup"
[0m16:15:27.991907 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:15:27.994906 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:15:27.995663 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public_public"."raw_data__dbt_tmp" rename to "raw_data"
[0m16:15:27.995663 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:15:28.008689 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m16:15:28.009690 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:15:28.009690 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m16:15:28.010689 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m16:15:28.016690 [debug] [Thread-1  ]: Applying DROP to: "krisha_data"."public_public"."raw_data__dbt_backup"
[0m16:15:28.019690 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:15:28.020690 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public_public"."raw_data__dbt_backup" cascade
[0m16:15:28.024690 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m16:15:28.026690 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: Close
[0m16:15:28.028691 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00262d86-cdbc-4885-8125-e902cf04c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179780CF6A0>]}
[0m16:15:28.028977 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public_public.raw_data ....................... [[32mSELECT 0[0m in 0.16s]
[0m16:15:28.030438 [debug] [Thread-1  ]: Finished running node model.krisha_data_pipeline.raw_data
[0m16:15:28.030438 [debug] [Thread-3  ]: Began running node model.krisha_data_pipeline.transform_data
[0m16:15:28.031528 [info ] [Thread-3  ]: 2 of 3 START sql table model public_public.transform_data ...................... [RUN]
[0m16:15:28.032482 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.krisha_data_pipeline.transform_data'
[0m16:15:28.032482 [debug] [Thread-3  ]: Began compiling node model.krisha_data_pipeline.transform_data
[0m16:15:28.035540 [debug] [Thread-3  ]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m16:15:28.036466 [debug] [Thread-3  ]: Began executing node model.krisha_data_pipeline.transform_data
[0m16:15:28.039473 [debug] [Thread-3  ]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m16:15:28.039473 [debug] [Thread-3  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m16:15:28.040466 [debug] [Thread-3  ]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m16:15:28.040466 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:15:28.070628 [debug] [Thread-3  ]: SQL status: BEGIN in 0.030 seconds
[0m16:15:28.070628 [debug] [Thread-3  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m16:15:28.071620 [debug] [Thread-3  ]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public_public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    

select
  *
from "krisha_data"."public_public"."raw_data"
where price is not null
  );
  
[0m16:15:28.076906 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.004 seconds
[0m16:15:28.081932 [debug] [Thread-3  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m16:15:28.082930 [debug] [Thread-3  ]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public_public"."transform_data" rename to "transform_data__dbt_backup"
[0m16:15:28.083930 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:15:28.085929 [debug] [Thread-3  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m16:15:28.086922 [debug] [Thread-3  ]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public_public"."transform_data__dbt_tmp" rename to "transform_data"
[0m16:15:28.087923 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:15:28.088929 [debug] [Thread-3  ]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m16:15:28.089922 [debug] [Thread-3  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m16:15:28.089922 [debug] [Thread-3  ]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m16:15:28.090921 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m16:15:28.092929 [debug] [Thread-3  ]: Applying DROP to: "krisha_data"."public_public"."transform_data__dbt_backup"
[0m16:15:28.093922 [debug] [Thread-3  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m16:15:28.093922 [debug] [Thread-3  ]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
drop table if exists "krisha_data"."public_public"."transform_data__dbt_backup" cascade
[0m16:15:28.095929 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.001 seconds
[0m16:15:28.096929 [debug] [Thread-3  ]: On model.krisha_data_pipeline.transform_data: Close
[0m16:15:28.097923 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00262d86-cdbc-4885-8125-e902cf04c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001797427F9D0>]}
[0m16:15:28.098929 [info ] [Thread-3  ]: 2 of 3 OK created sql table model public_public.transform_data ................. [[32mSELECT 0[0m in 0.07s]
[0m16:15:28.099712 [debug] [Thread-3  ]: Finished running node model.krisha_data_pipeline.transform_data
[0m16:15:28.099712 [debug] [Thread-2  ]: Began running node model.krisha_data_pipeline.final_model
[0m16:15:28.100793 [info ] [Thread-2  ]: 3 of 3 START sql table model public_public.final_model ......................... [RUN]
[0m16:15:28.101784 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.krisha_data_pipeline.final_model'
[0m16:15:28.101784 [debug] [Thread-2  ]: Began compiling node model.krisha_data_pipeline.final_model
[0m16:15:28.104791 [debug] [Thread-2  ]: Writing injected SQL for node "model.krisha_data_pipeline.final_model"
[0m16:15:28.106184 [debug] [Thread-2  ]: Began executing node model.krisha_data_pipeline.final_model
[0m16:15:28.110248 [debug] [Thread-2  ]: Writing runtime sql for node "model.krisha_data_pipeline.final_model"
[0m16:15:28.111239 [debug] [Thread-2  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m16:15:28.111239 [debug] [Thread-2  ]: On model.krisha_data_pipeline.final_model: BEGIN
[0m16:15:28.111239 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:15:28.143737 [debug] [Thread-2  ]: SQL status: BEGIN in 0.032 seconds
[0m16:15:28.144723 [debug] [Thread-2  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m16:15:28.145731 [debug] [Thread-2  ]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */

  
    

  create  table "krisha_data"."public_public"."final_model__dbt_tmp"
  
  
    as
  
  (
    

select
  name,
  rooms,
  sqm,
  price,
  city,
  date,
  year_of_est
from "krisha_data"."public_public"."transform_data"
order by price desc
  );
  
[0m16:15:28.148797 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.003 seconds
[0m16:15:28.152618 [debug] [Thread-2  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m16:15:28.153623 [debug] [Thread-2  ]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
alter table "krisha_data"."public_public"."final_model" rename to "final_model__dbt_backup"
[0m16:15:28.154611 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:15:28.157683 [debug] [Thread-2  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m16:15:28.157683 [debug] [Thread-2  ]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
alter table "krisha_data"."public_public"."final_model__dbt_tmp" rename to "final_model"
[0m16:15:28.158675 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:15:28.160683 [debug] [Thread-2  ]: On model.krisha_data_pipeline.final_model: COMMIT
[0m16:15:28.161682 [debug] [Thread-2  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m16:15:28.161682 [debug] [Thread-2  ]: On model.krisha_data_pipeline.final_model: COMMIT
[0m16:15:28.162675 [debug] [Thread-2  ]: SQL status: COMMIT in 0.000 seconds
[0m16:15:28.164684 [debug] [Thread-2  ]: Applying DROP to: "krisha_data"."public_public"."final_model__dbt_backup"
[0m16:15:28.165682 [debug] [Thread-2  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m16:15:28.165682 [debug] [Thread-2  ]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
drop table if exists "krisha_data"."public_public"."final_model__dbt_backup" cascade
[0m16:15:28.168064 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.001 seconds
[0m16:15:28.169061 [debug] [Thread-2  ]: On model.krisha_data_pipeline.final_model: Close
[0m16:15:28.170055 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00262d86-cdbc-4885-8125-e902cf04c661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179780E8370>]}
[0m16:15:28.171063 [info ] [Thread-2  ]: 3 of 3 OK created sql table model public_public.final_model .................... [[32mSELECT 0[0m in 0.07s]
[0m16:15:28.172078 [debug] [Thread-2  ]: Finished running node model.krisha_data_pipeline.final_model
[0m16:15:28.173093 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:28.173093 [debug] [MainThread]: On master: BEGIN
[0m16:15:28.173093 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:15:28.207232 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m16:15:28.207232 [debug] [MainThread]: On master: COMMIT
[0m16:15:28.207232 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:28.208232 [debug] [MainThread]: On master: COMMIT
[0m16:15:28.208232 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:15:28.209232 [debug] [MainThread]: On master: Close
[0m16:15:28.209232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:28.210232 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m16:15:28.210232 [debug] [MainThread]: Connection 'list_krisha_data_public_public' was properly closed.
[0m16:15:28.210232 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.raw_data' was properly closed.
[0m16:15:28.211185 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.transform_data' was properly closed.
[0m16:15:28.211283 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.final_model' was properly closed.
[0m16:15:28.211283 [info ] [MainThread]: 
[0m16:15:28.212323 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m16:15:28.213314 [debug] [MainThread]: Command end result
[0m16:15:28.232120 [debug] [MainThread]: Wrote artifact WritableManifest to C:\krisha_data_pipeline\target\manifest.json
[0m16:15:28.234060 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\krisha_data_pipeline\target\semantic_manifest.json
[0m16:15:28.239806 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\krisha_data_pipeline\target\run_results.json
[0m16:15:28.239806 [info ] [MainThread]: 
[0m16:15:28.240848 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:15:28.241842 [info ] [MainThread]: 
[0m16:15:28.241842 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:15:28.242843 [debug] [MainThread]: Command `dbt run` succeeded at 16:15:28.242843 after 2.04 seconds
[0m16:15:28.243843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179743884C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017977C8FC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017977C8F4F0>]}
[0m16:15:28.244285 [debug] [MainThread]: Flushing usage events
[0m16:15:29.062314 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:30:42.084425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4E9C48580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EBCD0F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EBCD0D60>]}


============================== 16:30:42.087482 | e872df3f-4466-410a-9502-4eb3d8ff5b79 ==============================
[0m16:30:42.087482 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:30:42.088482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\krisha_data_pipeline\\logs', 'profiles_dir': 'C:\\krisha_data_pipeline', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:30:42.237160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e872df3f-4466-410a-9502-4eb3d8ff5b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4E8265F10>]}
[0m16:30:42.284628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e872df3f-4466-410a-9502-4eb3d8ff5b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EB61A4C0>]}
[0m16:30:42.285629 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:30:42.456027 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:30:42.538007 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:30:42.538007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e872df3f-4466-410a-9502-4eb3d8ff5b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EB640B80>]}
[0m16:30:43.273726 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.krisha_data_pipeline.raw_data' (models\raw_data.sql) depends on a node named 'raw_flats' which was not found
[0m16:30:43.274798 [debug] [MainThread]: Command `dbt run` failed at 16:30:43.274798 after 1.24 seconds
[0m16:30:43.275724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4E9C48580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EC327820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4EC363CA0>]}
[0m16:30:43.275724 [debug] [MainThread]: Flushing usage events
[0m16:30:44.081049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:13.286429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B5B078520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B5D110F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B5D110DC0>]}


============================== 16:53:13.289552 | b1db35ff-72c0-4e10-9e2b-84fd6071cfbf ==============================
[0m16:53:13.289552 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:53:13.290610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\krisha_data_pipeline\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\krisha_data_pipeline', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:53:13.429544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1db35ff-72c0-4e10-9e2b-84fd6071cfbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B5D19FAC0>]}
[0m16:53:13.473693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1db35ff-72c0-4e10-9e2b-84fd6071cfbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B5CA98E20>]}
[0m16:53:13.474693 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:53:13.630650 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:53:13.706651 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:53:13.707650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b1db35ff-72c0-4e10-9e2b-84fd6071cfbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B5CA643A0>]}
[0m16:53:14.421089 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.krisha_data_pipeline.raw_data' (models\raw_data.sql) depends on a node named 'raw_flats' which was not found
[0m16:53:14.422082 [debug] [MainThread]: Command `dbt run` failed at 16:53:14.422082 after 1.19 seconds
[0m16:53:14.422082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B5B078520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B5D7677F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B5D7A3C70>]}
[0m16:53:14.423082 [debug] [MainThread]: Flushing usage events
[0m16:53:15.284129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:25.497436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3ECE89580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3EEF0FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3EEF0FD60>]}


============================== 17:06:25.500435 | 7465bc6e-c6d2-4b28-a5f8-ec795c328f29 ==============================
[0m17:06:25.500435 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:06:25.501435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\krisha_data_pipeline', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\krisha_data_pipeline\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:06:25.646927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7465bc6e-c6d2-4b28-a5f8-ec795c328f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3EEFFA1F0>]}
[0m17:06:25.693406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7465bc6e-c6d2-4b28-a5f8-ec795c328f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3EF086130>]}
[0m17:06:25.694411 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:06:25.869615 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:06:25.949618 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:06:25.950618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7465bc6e-c6d2-4b28-a5f8-ec795c328f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3EE880B80>]}
[0m17:06:26.741001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7465bc6e-c6d2-4b28-a5f8-ec795c328f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3EF5D4130>]}
[0m17:06:26.792983 [debug] [MainThread]: Wrote artifact WritableManifest to C:\krisha_data_pipeline\target\manifest.json
[0m17:06:26.796990 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\krisha_data_pipeline\target\semantic_manifest.json
[0m17:06:26.810343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7465bc6e-c6d2-4b28-a5f8-ec795c328f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3EF628F40>]}
[0m17:06:26.810343 [info ] [MainThread]: Found 3 models, 433 macros
[0m17:06:26.811354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7465bc6e-c6d2-4b28-a5f8-ec795c328f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3EF5A5D30>]}
[0m17:06:26.812369 [info ] [MainThread]: 
[0m17:06:26.813385 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:06:26.813385 [info ] [MainThread]: 
[0m17:06:26.814378 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:06:26.819386 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m17:06:26.877799 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m17:06:26.877799 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m17:06:26.878791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:26.908499 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m17:06:26.909499 [debug] [ThreadPool]: On list_krisha_data: Close
[0m17:06:26.910492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m17:06:26.916494 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:06:26.916494 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m17:06:26.917495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:26.943640 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m17:06:26.944639 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:06:26.944639 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:06:26.947711 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m17:06:26.949719 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m17:06:26.949719 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m17:06:26.954722 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:26.954722 [debug] [MainThread]: On master: BEGIN
[0m17:06:26.955722 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:26.986103 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m17:06:26.986103 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:26.987096 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:06:26.990102 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m17:06:26.992177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7465bc6e-c6d2-4b28-a5f8-ec795c328f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3EB3B08B0>]}
[0m17:06:26.992177 [debug] [MainThread]: On master: ROLLBACK
[0m17:06:26.993224 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:26.993224 [debug] [MainThread]: On master: BEGIN
[0m17:06:26.994215 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:06:26.994215 [debug] [MainThread]: On master: COMMIT
[0m17:06:26.995215 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:26.995708 [debug] [MainThread]: On master: COMMIT
[0m17:06:26.995708 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:06:26.995708 [debug] [MainThread]: On master: Close
[0m17:06:26.998767 [debug] [Thread-1  ]: Began running node model.krisha_data_pipeline.raw_data
[0m17:06:26.999785 [info ] [Thread-1  ]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m17:06:26.999785 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m17:06:27.000800 [debug] [Thread-1  ]: Began compiling node model.krisha_data_pipeline.raw_data
[0m17:06:27.006799 [debug] [Thread-1  ]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m17:06:27.007970 [debug] [Thread-1  ]: Began executing node model.krisha_data_pipeline.raw_data
[0m17:06:27.040090 [debug] [Thread-1  ]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m17:06:27.041091 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:06:27.042091 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m17:06:27.042091 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:06:27.070167 [debug] [Thread-1  ]: SQL status: BEGIN in 0.027 seconds
[0m17:06:27.070167 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:06:27.071165 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql
select * 
from raw_flats
where price is not null;
  );
  
[0m17:06:27.072165 [debug] [Thread-1  ]: Postgres adapter: Postgres error: ОШИБКА:  ошибка синтаксиса (примерное положение: ";")
LINE 15: where price is not null;
                                ^

[0m17:06:27.072165 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: ROLLBACK
[0m17:06:27.073168 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: Close
[0m17:06:27.075170 [debug] [Thread-1  ]: Database Error in model raw_data (models\raw_data.sql)
  ОШИБКА:  ошибка синтаксиса (примерное положение: ";")
  LINE 15: where price is not null;
                                  ^
  compiled code at target\run\krisha_data_pipeline\models\raw_data.sql
[0m17:06:27.077169 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7465bc6e-c6d2-4b28-a5f8-ec795c328f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3ECD7FEE0>]}
[0m17:06:27.078169 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model public.raw_data .......................... [[31mERROR[0m in 0.08s]
[0m17:06:27.079209 [debug] [Thread-1  ]: Finished running node model.krisha_data_pipeline.raw_data
[0m17:06:27.079209 [debug] [Thread-4  ]: Marking all children of 'model.krisha_data_pipeline.raw_data' to be skipped because of status 'error'.  Reason: Database Error in model raw_data (models\raw_data.sql)
  ОШИБКА:  ошибка синтаксиса (примерное положение: ";")
  LINE 15: where price is not null;
                                  ^
  compiled code at target\run\krisha_data_pipeline\models\raw_data.sql.
[0m17:06:27.080226 [debug] [Thread-1  ]: Began running node model.krisha_data_pipeline.transform_data
[0m17:06:27.081217 [info ] [Thread-1  ]: 2 of 3 SKIP relation public.transform_data ..................................... [[33mSKIP[0m]
[0m17:06:27.081217 [debug] [Thread-1  ]: Finished running node model.krisha_data_pipeline.transform_data
[0m17:06:27.082218 [debug] [Thread-1  ]: Began running node model.krisha_data_pipeline.final_model
[0m17:06:27.082218 [info ] [Thread-1  ]: 3 of 3 SKIP relation public.final_model ........................................ [[33mSKIP[0m]
[0m17:06:27.083217 [debug] [Thread-1  ]: Finished running node model.krisha_data_pipeline.final_model
[0m17:06:27.084920 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:27.085494 [debug] [MainThread]: On master: BEGIN
[0m17:06:27.086075 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:06:27.114685 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m17:06:27.114685 [debug] [MainThread]: On master: COMMIT
[0m17:06:27.115788 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:27.116287 [debug] [MainThread]: On master: COMMIT
[0m17:06:27.116287 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:06:27.117330 [debug] [MainThread]: On master: Close
[0m17:06:27.117330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:27.118326 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m17:06:27.118326 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m17:06:27.118326 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.raw_data' was properly closed.
[0m17:06:27.119326 [info ] [MainThread]: 
[0m17:06:27.119326 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m17:06:27.120327 [debug] [MainThread]: Command end result
[0m17:06:27.140299 [debug] [MainThread]: Wrote artifact WritableManifest to C:\krisha_data_pipeline\target\manifest.json
[0m17:06:27.142292 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\krisha_data_pipeline\target\semantic_manifest.json
[0m17:06:27.149606 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\krisha_data_pipeline\target\run_results.json
[0m17:06:27.149606 [info ] [MainThread]: 
[0m17:06:27.150858 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:06:27.150858 [info ] [MainThread]: 
[0m17:06:27.151880 [error] [MainThread]:   Database Error in model raw_data (models\raw_data.sql)
  ОШИБКА:  ошибка синтаксиса (примерное положение: ";")
  LINE 15: where price is not null;
                                  ^
  compiled code at target\run\krisha_data_pipeline\models\raw_data.sql
[0m17:06:27.152881 [info ] [MainThread]: 
[0m17:06:27.153881 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m17:06:27.154887 [debug] [MainThread]: Command `dbt run` failed at 17:06:27.153881 after 1.71 seconds
[0m17:06:27.154887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3ECE89580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3EF086130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3ED1A59D0>]}
[0m17:06:27.154887 [debug] [MainThread]: Flushing usage events
[0m17:06:28.067404 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:18.430588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB69F495B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB6BFD0BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB6BFD0F40>]}


============================== 17:16:18.434229 | ad28c036-f154-436f-95e5-41e5d29e67bd ==============================
[0m17:16:18.434229 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:16:18.435238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\krisha_data_pipeline', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\krisha_data_pipeline\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:16:18.597124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad28c036-f154-436f-95e5-41e5d29e67bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB68565F10>]}
[0m17:16:18.647274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad28c036-f154-436f-95e5-41e5d29e67bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB6B381490>]}
[0m17:16:18.648274 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:16:18.827826 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:16:18.929126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m17:16:18.930127 [debug] [MainThread]: Partial parsing: added file: krisha_data_pipeline://models\schema.yml
[0m17:16:18.930127 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\final_model.sql
[0m17:16:18.931314 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\transform_data.sql
[0m17:16:18.931314 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\raw_data.sql
[0m17:16:19.305460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad28c036-f154-436f-95e5-41e5d29e67bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB6C1102B0>]}
[0m17:16:19.371621 [debug] [MainThread]: Wrote artifact WritableManifest to C:\krisha_data_pipeline\target\manifest.json
[0m17:16:19.375622 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\krisha_data_pipeline\target\semantic_manifest.json
[0m17:16:19.387682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad28c036-f154-436f-95e5-41e5d29e67bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB6C57B2E0>]}
[0m17:16:19.388619 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m17:16:19.389618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad28c036-f154-436f-95e5-41e5d29e67bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB6C527250>]}
[0m17:16:19.390626 [info ] [MainThread]: 
[0m17:16:19.391619 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:19.391619 [info ] [MainThread]: 
[0m17:16:19.392619 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:16:19.397219 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m17:16:19.446666 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m17:16:19.446666 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m17:16:19.447656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:19.477624 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.030 seconds
[0m17:16:19.479111 [debug] [ThreadPool]: On list_krisha_data: Close
[0m17:16:19.480128 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m17:16:19.485771 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:16:19.486780 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m17:16:19.486780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:19.514080 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m17:16:19.515098 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:16:19.515098 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:16:19.518117 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m17:16:19.519130 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m17:16:19.520324 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m17:16:19.524177 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:19.525178 [debug] [MainThread]: On master: BEGIN
[0m17:16:19.525178 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:19.560385 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m17:16:19.561398 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:19.562037 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:19.565108 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m17:16:19.566140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad28c036-f154-436f-95e5-41e5d29e67bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB6BF8E610>]}
[0m17:16:19.567147 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:19.567147 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:19.568139 [debug] [MainThread]: On master: BEGIN
[0m17:16:19.568139 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:16:19.569151 [debug] [MainThread]: On master: COMMIT
[0m17:16:19.569773 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:19.569773 [debug] [MainThread]: On master: COMMIT
[0m17:16:19.569773 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:16:19.570796 [debug] [MainThread]: On master: Close
[0m17:16:19.572797 [debug] [Thread-1  ]: Began running node model.krisha_data_pipeline.raw_data
[0m17:16:19.573799 [info ] [Thread-1  ]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m17:16:19.574745 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m17:16:19.574745 [debug] [Thread-1  ]: Began compiling node model.krisha_data_pipeline.raw_data
[0m17:16:19.581925 [debug] [Thread-1  ]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m17:16:19.583362 [debug] [Thread-1  ]: Began executing node model.krisha_data_pipeline.raw_data
[0m17:16:19.618281 [debug] [Thread-1  ]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m17:16:19.619274 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:16:19.619274 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m17:16:19.619274 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:16:19.647037 [debug] [Thread-1  ]: SQL status: BEGIN in 0.028 seconds
[0m17:16:19.648036 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:16:19.648912 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m17:16:19.652389 [debug] [Thread-1  ]: SQL status: SELECT 103 in 0.003 seconds
[0m17:16:19.661639 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:16:19.661639 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m17:16:19.662726 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:19.674918 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:16:19.675443 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:16:19.675443 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:16:19.676490 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m17:16:19.681489 [debug] [Thread-1  ]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m17:16:19.685496 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:16:19.685496 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m17:16:19.686497 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m17:16:19.688493 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: Close
[0m17:16:19.691155 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad28c036-f154-436f-95e5-41e5d29e67bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB6DB47A60>]}
[0m17:16:19.692157 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.12s]
[0m17:16:19.693277 [debug] [Thread-1  ]: Finished running node model.krisha_data_pipeline.raw_data
[0m17:16:19.693277 [debug] [Thread-1  ]: Began running node model.krisha_data_pipeline.transform_data
[0m17:16:19.694489 [info ] [Thread-1  ]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m17:16:19.695530 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m17:16:19.695530 [debug] [Thread-1  ]: Began compiling node model.krisha_data_pipeline.transform_data
[0m17:16:19.698544 [debug] [Thread-1  ]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m17:16:19.699544 [debug] [Thread-1  ]: Began executing node model.krisha_data_pipeline.transform_data
[0m17:16:19.703815 [debug] [Thread-1  ]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m17:16:19.704835 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:16:19.705414 [debug] [Thread-1  ]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m17:16:19.705414 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:19.736298 [debug] [Thread-1  ]: SQL status: BEGIN in 0.030 seconds
[0m17:16:19.737280 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:16:19.738277 [debug] [Thread-1  ]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

select *
from "krisha_data"."public"."raw_data"
where price > 0
  );
  
[0m17:16:19.742957 [debug] [Thread-1  ]: SQL status: SELECT 103 in 0.004 seconds
[0m17:16:19.745976 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:16:19.745976 [debug] [Thread-1  ]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public"."transform_data__dbt_tmp" rename to "transform_data"
[0m17:16:19.746959 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:19.748959 [debug] [Thread-1  ]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m17:16:19.748959 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:16:19.748959 [debug] [Thread-1  ]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m17:16:19.750160 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m17:16:19.752166 [debug] [Thread-1  ]: Applying DROP to: "krisha_data"."public"."transform_data__dbt_backup"
[0m17:16:19.753166 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:16:19.754174 [debug] [Thread-1  ]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
drop table if exists "krisha_data"."public"."transform_data__dbt_backup" cascade
[0m17:16:19.754174 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m17:16:19.756169 [debug] [Thread-1  ]: On model.krisha_data_pipeline.transform_data: Close
[0m17:16:19.756169 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad28c036-f154-436f-95e5-41e5d29e67bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB6DCFC280>]}
[0m17:16:19.757167 [info ] [Thread-1  ]: 2 of 3 OK created sql table model public.transform_data ........................ [[32mSELECT 103[0m in 0.06s]
[0m17:16:19.758240 [debug] [Thread-1  ]: Finished running node model.krisha_data_pipeline.transform_data
[0m17:16:19.759145 [debug] [Thread-1  ]: Began running node model.krisha_data_pipeline.final_model
[0m17:16:19.759641 [info ] [Thread-1  ]: 3 of 3 START sql table model public.final_model ................................ [RUN]
[0m17:16:19.759641 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.transform_data, now model.krisha_data_pipeline.final_model)
[0m17:16:19.760664 [debug] [Thread-1  ]: Began compiling node model.krisha_data_pipeline.final_model
[0m17:16:19.762662 [debug] [Thread-1  ]: Writing injected SQL for node "model.krisha_data_pipeline.final_model"
[0m17:16:19.763662 [debug] [Thread-1  ]: Began executing node model.krisha_data_pipeline.final_model
[0m17:16:19.766837 [debug] [Thread-1  ]: Writing runtime sql for node "model.krisha_data_pipeline.final_model"
[0m17:16:19.768242 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:16:19.768242 [debug] [Thread-1  ]: On model.krisha_data_pipeline.final_model: BEGIN
[0m17:16:19.768242 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:19.798747 [debug] [Thread-1  ]: SQL status: BEGIN in 0.030 seconds
[0m17:16:19.798747 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:16:19.799750 [debug] [Thread-1  ]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */

  
    

  create  table "krisha_data"."public"."final_model__dbt_tmp"
  
  
    as
  
  (
    -- models/final_model.sql

select *
from "krisha_data"."public"."transform_data"
  );
  
[0m17:16:19.803379 [debug] [Thread-1  ]: SQL status: SELECT 103 in 0.004 seconds
[0m17:16:19.807384 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:16:19.808115 [debug] [Thread-1  ]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
alter table "krisha_data"."public"."final_model__dbt_tmp" rename to "final_model"
[0m17:16:19.808964 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:19.810006 [debug] [Thread-1  ]: On model.krisha_data_pipeline.final_model: COMMIT
[0m17:16:19.811005 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:16:19.811005 [debug] [Thread-1  ]: On model.krisha_data_pipeline.final_model: COMMIT
[0m17:16:19.812049 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m17:16:19.816215 [debug] [Thread-1  ]: Applying DROP to: "krisha_data"."public"."final_model__dbt_backup"
[0m17:16:19.817213 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:16:19.817213 [debug] [Thread-1  ]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
drop table if exists "krisha_data"."public"."final_model__dbt_backup" cascade
[0m17:16:19.818219 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m17:16:19.820213 [debug] [Thread-1  ]: On model.krisha_data_pipeline.final_model: Close
[0m17:16:19.820213 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad28c036-f154-436f-95e5-41e5d29e67bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB6DD6FA00>]}
[0m17:16:19.821212 [info ] [Thread-1  ]: 3 of 3 OK created sql table model public.final_model ........................... [[32mSELECT 103[0m in 0.06s]
[0m17:16:19.822522 [debug] [Thread-1  ]: Finished running node model.krisha_data_pipeline.final_model
[0m17:16:19.823273 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:19.824291 [debug] [MainThread]: On master: BEGIN
[0m17:16:19.824291 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:19.852498 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m17:16:19.853509 [debug] [MainThread]: On master: COMMIT
[0m17:16:19.853509 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:19.854507 [debug] [MainThread]: On master: COMMIT
[0m17:16:19.854507 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:16:19.855498 [debug] [MainThread]: On master: Close
[0m17:16:19.855498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:19.855498 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m17:16:19.856498 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m17:16:19.857000 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.final_model' was properly closed.
[0m17:16:19.857251 [info ] [MainThread]: 
[0m17:16:19.858174 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m17:16:19.859432 [debug] [MainThread]: Command end result
[0m17:16:19.876129 [debug] [MainThread]: Wrote artifact WritableManifest to C:\krisha_data_pipeline\target\manifest.json
[0m17:16:19.878019 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\krisha_data_pipeline\target\semantic_manifest.json
[0m17:16:19.883554 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\krisha_data_pipeline\target\run_results.json
[0m17:16:19.883554 [info ] [MainThread]: 
[0m17:16:19.884548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:19.886186 [info ] [MainThread]: 
[0m17:16:19.886186 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:16:19.888214 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:19.887246 after 1.51 seconds
[0m17:16:19.888214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB69F495B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB6A2B9BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB6B2C7BB0>]}
[0m17:16:19.888214 [debug] [MainThread]: Flushing usage events
[0m17:16:20.741139 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:51.785006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D62CC9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D64D50F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D64D50D60>]}


============================== 17:16:51.788174 | b2ca7474-99f6-44f3-8582-5c5154f80417 ==============================
[0m17:16:51.788174 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:16:51.789174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\krisha_data_pipeline', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\krisha_data_pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:16:51.935685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2ca7474-99f6-44f3-8582-5c5154f80417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D612E4F10>]}
[0m17:16:51.980824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2ca7474-99f6-44f3-8582-5c5154f80417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D6469A4C0>]}
[0m17:16:51.981824 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:16:52.141729 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:16:52.258038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:52.258038 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:52.292147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2ca7474-99f6-44f3-8582-5c5154f80417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D652F6130>]}
[0m17:16:52.358077 [debug] [MainThread]: Wrote artifact WritableManifest to C:\krisha_data_pipeline\target\manifest.json
[0m17:16:52.361078 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\krisha_data_pipeline\target\semantic_manifest.json
[0m17:16:52.374078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2ca7474-99f6-44f3-8582-5c5154f80417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D65317CD0>]}
[0m17:16:52.375078 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m17:16:52.376070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2ca7474-99f6-44f3-8582-5c5154f80417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D65319970>]}
[0m17:16:52.377078 [info ] [MainThread]: 
[0m17:16:52.378072 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:52.378123 [info ] [MainThread]: 
[0m17:16:52.379139 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:16:52.384154 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m17:16:52.481442 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m17:16:52.481442 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m17:16:52.482443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:52.512595 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.030 seconds
[0m17:16:52.513597 [debug] [ThreadPool]: On list_krisha_data: Close
[0m17:16:52.515588 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m17:16:52.521056 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:16:52.521056 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m17:16:52.522075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:52.548725 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m17:16:52.548725 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:16:52.548725 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:16:52.551732 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m17:16:52.552821 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m17:16:52.553943 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m17:16:52.558911 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:52.559919 [debug] [MainThread]: On master: BEGIN
[0m17:16:52.559919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:52.590969 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m17:16:52.592038 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:52.592038 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:52.596033 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m17:16:52.597036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2ca7474-99f6-44f3-8582-5c5154f80417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D6531F1F0>]}
[0m17:16:52.597036 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:52.598041 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:52.598041 [debug] [MainThread]: On master: BEGIN
[0m17:16:52.599104 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:16:52.599104 [debug] [MainThread]: On master: COMMIT
[0m17:16:52.600149 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:52.600149 [debug] [MainThread]: On master: COMMIT
[0m17:16:52.601174 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:16:52.601174 [debug] [MainThread]: On master: Close
[0m17:16:52.605297 [debug] [Thread-1  ]: Began running node model.krisha_data_pipeline.raw_data
[0m17:16:52.606328 [info ] [Thread-1  ]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m17:16:52.607387 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m17:16:52.607387 [debug] [Thread-1  ]: Began compiling node model.krisha_data_pipeline.raw_data
[0m17:16:52.614444 [debug] [Thread-1  ]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m17:16:52.615156 [debug] [Thread-1  ]: Began executing node model.krisha_data_pipeline.raw_data
[0m17:16:52.649339 [debug] [Thread-1  ]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m17:16:52.650792 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:16:52.650792 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m17:16:52.651824 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:16:52.779775 [debug] [Thread-1  ]: SQL status: BEGIN in 0.128 seconds
[0m17:16:52.780771 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:16:52.780771 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m17:16:52.784344 [debug] [Thread-1  ]: SQL status: SELECT 102 in 0.003 seconds
[0m17:16:52.795720 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:16:52.795720 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data" rename to "raw_data__dbt_backup"
[0m17:16:52.796717 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:52.799712 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:16:52.800722 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m17:16:52.801711 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:52.813816 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:16:52.814818 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:16:52.814818 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:16:52.815818 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m17:16:52.820818 [debug] [Thread-1  ]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m17:16:52.824818 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:16:52.824818 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m17:16:52.826816 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m17:16:52.828818 [debug] [Thread-1  ]: On model.krisha_data_pipeline.raw_data: Close
[0m17:16:52.830818 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2ca7474-99f6-44f3-8582-5c5154f80417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D657AB7C0>]}
[0m17:16:52.831282 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 102[0m in 0.22s]
[0m17:16:52.832319 [debug] [Thread-1  ]: Finished running node model.krisha_data_pipeline.raw_data
[0m17:16:52.833359 [debug] [Thread-1  ]: Began running node model.krisha_data_pipeline.transform_data
[0m17:16:52.834567 [info ] [Thread-1  ]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m17:16:52.835565 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m17:16:52.835565 [debug] [Thread-1  ]: Began compiling node model.krisha_data_pipeline.transform_data
[0m17:16:52.838639 [debug] [Thread-1  ]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m17:16:52.839642 [debug] [Thread-1  ]: Began executing node model.krisha_data_pipeline.transform_data
[0m17:16:52.842565 [debug] [Thread-1  ]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m17:16:52.843628 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:16:52.843628 [debug] [Thread-1  ]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m17:16:52.844564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:52.872649 [debug] [Thread-1  ]: SQL status: BEGIN in 0.028 seconds
[0m17:16:52.873643 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:16:52.873643 [debug] [Thread-1  ]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

select *
from "krisha_data"."public"."raw_data"
where price > 0
  );
  
[0m17:16:52.878499 [debug] [Thread-1  ]: SQL status: SELECT 102 in 0.004 seconds
[0m17:16:52.883702 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:16:52.883702 [debug] [Thread-1  ]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public"."transform_data" rename to "transform_data__dbt_backup"
[0m17:16:52.884694 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:52.887700 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:16:52.887700 [debug] [Thread-1  ]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public"."transform_data__dbt_tmp" rename to "transform_data"
[0m17:16:52.888698 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:52.890697 [debug] [Thread-1  ]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m17:16:52.890697 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:16:52.890697 [debug] [Thread-1  ]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m17:16:52.891697 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m17:16:52.894697 [debug] [Thread-1  ]: Applying DROP to: "krisha_data"."public"."transform_data__dbt_backup"
[0m17:16:52.895662 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:16:52.896162 [debug] [Thread-1  ]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
drop table if exists "krisha_data"."public"."transform_data__dbt_backup" cascade
[0m17:16:52.897663 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m17:16:52.898594 [debug] [Thread-1  ]: On model.krisha_data_pipeline.transform_data: Close
[0m17:16:52.899594 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2ca7474-99f6-44f3-8582-5c5154f80417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D62BBEEE0>]}
[0m17:16:52.900594 [info ] [Thread-1  ]: 2 of 3 OK created sql table model public.transform_data ........................ [[32mSELECT 102[0m in 0.07s]
[0m17:16:52.901304 [debug] [Thread-1  ]: Finished running node model.krisha_data_pipeline.transform_data
[0m17:16:52.902344 [debug] [Thread-1  ]: Began running node model.krisha_data_pipeline.final_model
[0m17:16:52.902344 [info ] [Thread-1  ]: 3 of 3 START sql table model public.final_model ................................ [RUN]
[0m17:16:52.903362 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.transform_data, now model.krisha_data_pipeline.final_model)
[0m17:16:52.903362 [debug] [Thread-1  ]: Began compiling node model.krisha_data_pipeline.final_model
[0m17:16:52.906364 [debug] [Thread-1  ]: Writing injected SQL for node "model.krisha_data_pipeline.final_model"
[0m17:16:52.907364 [debug] [Thread-1  ]: Began executing node model.krisha_data_pipeline.final_model
[0m17:16:52.910363 [debug] [Thread-1  ]: Writing runtime sql for node "model.krisha_data_pipeline.final_model"
[0m17:16:52.911362 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:16:52.911997 [debug] [Thread-1  ]: On model.krisha_data_pipeline.final_model: BEGIN
[0m17:16:52.911997 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:52.940204 [debug] [Thread-1  ]: SQL status: BEGIN in 0.028 seconds
[0m17:16:52.941284 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:16:52.941642 [debug] [Thread-1  ]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */

  
    

  create  table "krisha_data"."public"."final_model__dbt_tmp"
  
  
    as
  
  (
    -- models/final_model.sql

select *
from "krisha_data"."public"."transform_data"
  );
  
[0m17:16:52.946747 [debug] [Thread-1  ]: SQL status: SELECT 102 in 0.005 seconds
[0m17:16:52.950748 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:16:52.950748 [debug] [Thread-1  ]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
alter table "krisha_data"."public"."final_model" rename to "final_model__dbt_backup"
[0m17:16:52.951747 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:52.954823 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:16:52.955826 [debug] [Thread-1  ]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
alter table "krisha_data"."public"."final_model__dbt_tmp" rename to "final_model"
[0m17:16:52.956749 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:16:52.957751 [debug] [Thread-1  ]: On model.krisha_data_pipeline.final_model: COMMIT
[0m17:16:52.958751 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:16:52.958751 [debug] [Thread-1  ]: On model.krisha_data_pipeline.final_model: COMMIT
[0m17:16:52.959750 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m17:16:52.962751 [debug] [Thread-1  ]: Applying DROP to: "krisha_data"."public"."final_model__dbt_backup"
[0m17:16:52.963751 [debug] [Thread-1  ]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:16:52.963751 [debug] [Thread-1  ]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
drop table if exists "krisha_data"."public"."final_model__dbt_backup" cascade
[0m17:16:52.965819 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m17:16:52.966752 [debug] [Thread-1  ]: On model.krisha_data_pipeline.final_model: Close
[0m17:16:52.967751 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2ca7474-99f6-44f3-8582-5c5154f80417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D658FCFD0>]}
[0m17:16:52.968752 [info ] [Thread-1  ]: 3 of 3 OK created sql table model public.final_model ........................... [[32mSELECT 102[0m in 0.06s]
[0m17:16:52.969754 [debug] [Thread-1  ]: Finished running node model.krisha_data_pipeline.final_model
[0m17:16:52.970065 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:52.971088 [debug] [MainThread]: On master: BEGIN
[0m17:16:52.971088 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:52.999424 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m17:16:52.999424 [debug] [MainThread]: On master: COMMIT
[0m17:16:53.000415 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:53.000415 [debug] [MainThread]: On master: COMMIT
[0m17:16:53.001415 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:16:53.001415 [debug] [MainThread]: On master: Close
[0m17:16:53.002449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:53.003218 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m17:16:53.003344 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m17:16:53.003344 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.final_model' was properly closed.
[0m17:16:53.004128 [info ] [MainThread]: 
[0m17:16:53.005239 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m17:16:53.006308 [debug] [MainThread]: Command end result
[0m17:16:53.023641 [debug] [MainThread]: Wrote artifact WritableManifest to C:\krisha_data_pipeline\target\manifest.json
[0m17:16:53.026575 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\krisha_data_pipeline\target\semantic_manifest.json
[0m17:16:53.031584 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\krisha_data_pipeline\target\run_results.json
[0m17:16:53.032574 [info ] [MainThread]: 
[0m17:16:53.033621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:53.033621 [info ] [MainThread]: 
[0m17:16:53.034981 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:16:53.036210 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:53.036210 after 1.31 seconds
[0m17:16:53.037211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D62CC9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D65317040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D62FE49D0>]}
[0m17:16:53.037211 [debug] [MainThread]: Flushing usage events
[0m17:16:53.737890 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:52:22.662832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A65E29E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A65BF2A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A65F1FFED0>]}


============================== 16:52:22.668917 | c221937e-83fc-4421-9e6a-870d750beb7d ==============================
[0m16:52:22.668917 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:52:22.669516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:52:22.904215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c221937e-83fc-4421-9e6a-870d750beb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A65F47C050>]}
[0m16:52:22.962076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c221937e-83fc-4421-9e6a-870d750beb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A65F0F6F10>]}
[0m16:52:22.964090 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:52:23.238197 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:52:23.392581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m16:52:23.393155 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\schema.yml
[0m16:52:23.393561 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\raw_data.sql
[0m16:52:23.393934 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\transform_data.sql
[0m16:52:23.394304 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\final_model.sql
[0m16:52:23.702104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c221937e-83fc-4421-9e6a-870d750beb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A66055FE50>]}
[0m16:52:23.760660 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m16:52:23.764504 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m16:52:23.819015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c221937e-83fc-4421-9e6a-870d750beb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A65F23FD40>]}
[0m16:52:23.819439 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m16:52:23.819842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c221937e-83fc-4421-9e6a-870d750beb7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A660988C90>]}
[0m16:52:23.821393 [info ] [MainThread]: 
[0m16:52:23.821769 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:23.822094 [info ] [MainThread]: 
[0m16:52:23.822566 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:23.826563 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m16:52:24.020855 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m16:52:24.021206 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m16:52:24.021478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:24.068732 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m16:52:24.069366 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:52:24.069915 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m16:52:24.070293 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:52:24.070609 [debug] [ThreadPool]: On list_krisha_data: No close available on handle
[0m16:52:24.071402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:24.071743 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m16:52:24.072331 [info ] [MainThread]: 
[0m16:52:24.072753 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m16:52:24.073506 [error] [MainThread]: Encountered an error:
Database Error
  'utf-8' codec can't decode byte 0xc2 in position 61: invalid continuation byte
[0m16:52:24.074504 [debug] [MainThread]: Command `dbt run` failed at 16:52:24.074299 after 1.52 seconds
[0m16:52:24.075065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A660B89980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A65EFFB950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A66095BDD0>]}
[0m16:52:24.075555 [debug] [MainThread]: Flushing usage events
[0m16:52:25.157219 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:58.875965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA068DE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA2583D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA2583B10>]}


============================== 16:53:58.880090 | 527a096d-b1cb-41c9-9cea-b107cdc90ad7 ==============================
[0m16:53:58.880090 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:53:58.880594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:53:59.041485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '527a096d-b1cb-41c9-9cea-b107cdc90ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA272F5C0>]}
[0m16:53:59.100406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '527a096d-b1cb-41c9-9cea-b107cdc90ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA2519D00>]}
[0m16:53:59.101398 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:53:59.441330 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:53:59.577900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:53:59.578518 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:53:59.608162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '527a096d-b1cb-41c9-9cea-b107cdc90ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA2669D50>]}
[0m16:53:59.666003 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m16:53:59.670942 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m16:53:59.732542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '527a096d-b1cb-41c9-9cea-b107cdc90ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA07255E0>]}
[0m16:53:59.732957 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m16:53:59.733258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '527a096d-b1cb-41c9-9cea-b107cdc90ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA2A3B690>]}
[0m16:53:59.734687 [info ] [MainThread]: 
[0m16:53:59.734992 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:53:59.735253 [info ] [MainThread]: 
[0m16:53:59.735700 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:53:59.739176 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m16:53:59.845781 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m16:53:59.846132 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m16:53:59.846410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:59.898645 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.052 seconds
[0m16:53:59.899827 [debug] [ThreadPool]: On list_krisha_data: Close
[0m16:53:59.901304 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m16:53:59.906548 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m16:53:59.906917 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m16:53:59.907184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:59.951430 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m16:53:59.952131 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m16:53:59.952675 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:53:59.968208 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m16:53:59.969761 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m16:53:59.970302 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m16:53:59.976113 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:59.976528 [debug] [MainThread]: On master: BEGIN
[0m16:53:59.976832 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:54:00.023646 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m16:54:00.024035 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:00.024379 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:54:00.034744 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m16:54:00.035857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '527a096d-b1cb-41c9-9cea-b107cdc90ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA2DC53D0>]}
[0m16:54:00.036244 [debug] [MainThread]: On master: ROLLBACK
[0m16:54:00.036657 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:00.036926 [debug] [MainThread]: On master: BEGIN
[0m16:54:00.037381 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:54:00.037655 [debug] [MainThread]: On master: COMMIT
[0m16:54:00.037921 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:00.038174 [debug] [MainThread]: On master: COMMIT
[0m16:54:00.038508 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:54:00.038777 [debug] [MainThread]: On master: Close
[0m16:54:00.121908 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.raw_data
[0m16:54:00.122460 [info ] [Thread-1 (]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m16:54:00.122974 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m16:54:00.123300 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.raw_data
[0m16:54:00.130189 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m16:54:00.131260 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.raw_data
[0m16:54:00.168076 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m16:54:00.169640 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:54:00.170083 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m16:54:00.170383 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:54:00.218610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m16:54:00.218996 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:54:00.219305 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m16:54:00.231792 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.012 seconds
[0m16:54:00.239812 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:54:00.240180 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m16:54:00.241287 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:54:00.254287 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m16:54:00.254690 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:54:00.255016 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m16:54:00.257275 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:54:00.262819 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m16:54:00.267467 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m16:54:00.267887 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m16:54:00.268747 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:54:00.270946 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: Close
[0m16:54:00.273556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527a096d-b1cb-41c9-9cea-b107cdc90ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA2B62450>]}
[0m16:54:00.274268 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.15s]
[0m16:54:00.274906 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.raw_data
[0m16:54:00.275682 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.transform_data
[0m16:54:00.276117 [info ] [Thread-1 (]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m16:54:00.276535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m16:54:00.276896 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.transform_data
[0m16:54:00.279178 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m16:54:00.280198 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.transform_data
[0m16:54:00.283291 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m16:54:00.284208 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m16:54:00.284551 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m16:54:00.284856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:00.328002 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m16:54:00.328420 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m16:54:00.328762 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

select *
from "krisha_data"."public"."raw_data"
where price > 0
  );
  
[0m16:54:00.340277 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.011 seconds
[0m16:54:00.343847 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m16:54:00.344345 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public"."transform_data__dbt_tmp" rename to "transform_data"
[0m16:54:00.345559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:54:00.347587 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m16:54:00.348110 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m16:54:00.348479 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m16:54:00.350991 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:54:00.353471 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."transform_data__dbt_backup"
[0m16:54:00.354641 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m16:54:00.355140 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
drop table if exists "krisha_data"."public"."transform_data__dbt_backup" cascade
[0m16:54:00.355881 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m16:54:00.357196 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: Close
[0m16:54:00.357805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527a096d-b1cb-41c9-9cea-b107cdc90ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA2B1BD80>]}
[0m16:54:00.358433 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.transform_data ........................ [[32mSELECT 103[0m in 0.08s]
[0m16:54:00.359022 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.transform_data
[0m16:54:00.359817 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.final_model
[0m16:54:00.360411 [info ] [Thread-1 (]: 3 of 3 START sql table model public.final_model ................................ [RUN]
[0m16:54:00.361098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.transform_data, now model.krisha_data_pipeline.final_model)
[0m16:54:00.361595 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.final_model
[0m16:54:00.364795 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.final_model"
[0m16:54:00.365870 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.final_model
[0m16:54:00.368739 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.final_model"
[0m16:54:00.369676 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m16:54:00.370041 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: BEGIN
[0m16:54:00.370351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:00.522930 [debug] [Thread-1 (]: SQL status: BEGIN in 0.153 seconds
[0m16:54:00.523323 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m16:54:00.523635 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */

  
    

  create  table "krisha_data"."public"."final_model__dbt_tmp"
  
  
    as
  
  (
    -- models/final_model.sql

select *
from "krisha_data"."public"."transform_data"
  );
  
[0m16:54:00.532517 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.009 seconds
[0m16:54:00.535315 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m16:54:00.535652 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
alter table "krisha_data"."public"."final_model__dbt_tmp" rename to "final_model"
[0m16:54:00.537372 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:54:00.538645 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: COMMIT
[0m16:54:00.538991 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m16:54:00.539298 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: COMMIT
[0m16:54:00.541090 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:54:00.543175 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."final_model__dbt_backup"
[0m16:54:00.543765 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m16:54:00.544080 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
drop table if exists "krisha_data"."public"."final_model__dbt_backup" cascade
[0m16:54:00.544614 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m16:54:00.545746 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: Close
[0m16:54:00.546292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527a096d-b1cb-41c9-9cea-b107cdc90ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA2F96030>]}
[0m16:54:00.547051 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.final_model ........................... [[32mSELECT 103[0m in 0.19s]
[0m16:54:00.547875 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.final_model
[0m16:54:00.549395 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:00.549773 [debug] [MainThread]: On master: BEGIN
[0m16:54:00.550162 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:54:00.601286 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m16:54:00.601673 [debug] [MainThread]: On master: COMMIT
[0m16:54:00.601967 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:00.602236 [debug] [MainThread]: On master: COMMIT
[0m16:54:00.602635 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:54:00.602989 [debug] [MainThread]: On master: Close
[0m16:54:00.603648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:00.604175 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m16:54:00.604491 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m16:54:00.604738 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.final_model' was properly closed.
[0m16:54:00.605473 [info ] [MainThread]: 
[0m16:54:00.605825 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m16:54:00.606756 [debug] [MainThread]: Command end result
[0m16:54:00.622464 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m16:54:00.624361 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m16:54:00.629721 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\run_results.json
[0m16:54:00.630039 [info ] [MainThread]: 
[0m16:54:00.630373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:54:00.630670 [info ] [MainThread]: 
[0m16:54:00.630981 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:54:00.631675 [debug] [MainThread]: Command `dbt run` succeeded at 16:54:00.631568 after 1.87 seconds
[0m16:54:00.631998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA2ED8450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA29DB3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFA25C1DA0>]}
[0m16:54:00.632323 [debug] [MainThread]: Flushing usage events
[0m16:54:01.567185 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:40.307716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC901E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC6CCA5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC9F83ED0>]}


============================== 17:07:40.314426 | be146e30-d6fe-4b08-9dcf-af2989c8320c ==============================
[0m17:07:40.314426 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:07:40.315133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:07:40.528254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be146e30-d6fe-4b08-9dcf-af2989c8320c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DACA192D70>]}
[0m17:07:40.586141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be146e30-d6fe-4b08-9dcf-af2989c8320c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC9E73020>]}
[0m17:07:40.587297 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:07:40.860217 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:07:40.997846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 3 files changed.
[0m17:07:40.998315 [debug] [MainThread]: Partial parsing: added file: krisha_data_pipeline://macros\convert_currency.sql
[0m17:07:40.998623 [debug] [MainThread]: Partial parsing: added file: krisha_data_pipeline://macros\detect_property_type.sql
[0m17:07:40.998929 [debug] [MainThread]: Partial parsing: added file: krisha_data_pipeline://macros\is_weekend.sql
[0m17:07:40.999219 [debug] [MainThread]: Partial parsing: added file: krisha_data_pipeline://macros\round_price.sql
[0m17:07:40.999506 [debug] [MainThread]: Partial parsing: added file: krisha_data_pipeline://macros\standardize_date.sql
[0m17:07:41.000104 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\schema.yml
[0m17:07:41.000410 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\transform_data.sql
[0m17:07:41.000704 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\final_model.sql
[0m17:07:41.547730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be146e30-d6fe-4b08-9dcf-af2989c8320c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DACB387050>]}
[0m17:07:41.623527 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:07:41.627009 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:07:41.708636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be146e30-d6fe-4b08-9dcf-af2989c8320c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAC90B9130>]}
[0m17:07:41.709182 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 438 macros
[0m17:07:41.709739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be146e30-d6fe-4b08-9dcf-af2989c8320c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DACB60C210>]}
[0m17:07:41.712628 [info ] [MainThread]: 
[0m17:07:41.713398 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:41.714041 [info ] [MainThread]: 
[0m17:07:41.714720 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:07:41.719750 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m17:07:41.830269 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m17:07:41.830620 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m17:07:41.830884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:41.916483 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.085 seconds
[0m17:07:41.917689 [debug] [ThreadPool]: On list_krisha_data: Close
[0m17:07:41.919262 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m17:07:41.924656 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:07:41.925062 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m17:07:41.925341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:41.970414 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m17:07:41.970776 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:07:41.971055 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:07:41.987218 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.016 seconds
[0m17:07:41.988447 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m17:07:41.989064 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m17:07:41.994050 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:41.994387 [debug] [MainThread]: On master: BEGIN
[0m17:07:41.994638 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:07:42.039446 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m17:07:42.039791 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:42.040107 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:07:42.054999 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m17:07:42.056074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be146e30-d6fe-4b08-9dcf-af2989c8320c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DACB952680>]}
[0m17:07:42.056448 [debug] [MainThread]: On master: ROLLBACK
[0m17:07:42.056873 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:42.057139 [debug] [MainThread]: On master: BEGIN
[0m17:07:42.057601 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:07:42.057870 [debug] [MainThread]: On master: COMMIT
[0m17:07:42.058128 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:42.058374 [debug] [MainThread]: On master: COMMIT
[0m17:07:42.058710 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:07:42.058982 [debug] [MainThread]: On master: Close
[0m17:07:42.064398 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.raw_data
[0m17:07:42.064899 [info ] [Thread-1 (]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m17:07:42.065543 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m17:07:42.065879 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.raw_data
[0m17:07:42.073197 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m17:07:42.074246 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.raw_data
[0m17:07:42.116088 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m17:07:42.117273 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:07:42.117660 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m17:07:42.117977 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:07:42.275081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m17:07:42.275471 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:07:42.275787 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m17:07:42.298384 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.022 seconds
[0m17:07:42.307035 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:07:42.307434 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data" rename to "raw_data__dbt_backup"
[0m17:07:42.308857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:07:42.311982 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:07:42.312348 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m17:07:42.313102 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:07:42.327218 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:07:42.327623 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:07:42.327930 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:07:42.329656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:07:42.334972 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m17:07:42.339207 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:07:42.339591 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m17:07:42.350606 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m17:07:42.352823 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: Close
[0m17:07:42.354751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be146e30-d6fe-4b08-9dcf-af2989c8320c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DACBB1C050>]}
[0m17:07:42.355451 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.29s]
[0m17:07:42.356219 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.raw_data
[0m17:07:42.356880 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.transform_data
[0m17:07:42.357334 [info ] [Thread-1 (]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m17:07:42.357905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m17:07:42.358243 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.transform_data
[0m17:07:42.361421 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m17:07:42.362285 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.transform_data
[0m17:07:42.364707 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m17:07:42.365896 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:07:42.366369 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m17:07:42.366688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:42.535733 [debug] [Thread-1 (]: SQL status: BEGIN in 0.169 seconds
[0m17:07:42.536148 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:07:42.536490 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

with raw as (

    select *
    from "krisha_data"."public"."raw_data"
    where price > 0

)

select
    id,
    
    round(cast(price as numeric), -3)
 as rounded_price,
    address,
    
    case
        when lower(address) like '%дом%' then 'house'
        when lower(address) like '%квартира%' then 'flat'
        else 'unknown'
    end
 as property_type,
    
    to_date(created_at, 'YYYY-MM-DD')
 as standardized_date,
    
    case
        when extract(dow from to_date(created_at, 'YYYY-MM-DD')) in (0, 6) then true
        else false
    end
 as is_weekend
from raw
  );
  
[0m17:07:42.541033 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец "id" не существует
LINE 23:     id,
             ^

[0m17:07:42.541415 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: ROLLBACK
[0m17:07:42.541914 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: Close
[0m17:07:42.589714 [debug] [Thread-1 (]: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "id" не существует
  LINE 23:     id,
               ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:07:42.590211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be146e30-d6fe-4b08-9dcf-af2989c8320c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DACBA94680>]}
[0m17:07:42.590761 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.transform_data .................... [[31mERROR[0m in 0.23s]
[0m17:07:42.591458 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.transform_data
[0m17:07:42.591998 [debug] [Thread-4 (]: Marking all children of 'model.krisha_data_pipeline.transform_data' to be skipped because of status 'error'.  Reason: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "id" не существует
  LINE 23:     id,
               ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql.
[0m17:07:42.593073 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.final_model
[0m17:07:42.593435 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.final_model ........................................ [[33mSKIP[0m]
[0m17:07:42.593927 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.final_model
[0m17:07:42.595042 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:42.595416 [debug] [MainThread]: On master: BEGIN
[0m17:07:42.595711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:07:42.639664 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m17:07:42.640030 [debug] [MainThread]: On master: COMMIT
[0m17:07:42.640305 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:42.640565 [debug] [MainThread]: On master: COMMIT
[0m17:07:42.640964 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:07:42.641250 [debug] [MainThread]: On master: Close
[0m17:07:42.641677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:42.641953 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m17:07:42.642202 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m17:07:42.642436 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.transform_data' was properly closed.
[0m17:07:42.643205 [info ] [MainThread]: 
[0m17:07:42.643687 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m17:07:42.644722 [debug] [MainThread]: Command end result
[0m17:07:42.662348 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:07:42.664469 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:07:42.670138 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\run_results.json
[0m17:07:42.670459 [info ] [MainThread]: 
[0m17:07:42.670957 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:07:42.671427 [info ] [MainThread]: 
[0m17:07:42.671957 [error] [MainThread]:   Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "id" не существует
  LINE 23:     id,
               ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:07:42.673016 [info ] [MainThread]: 
[0m17:07:42.673622 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m17:07:42.674477 [debug] [MainThread]: Command `dbt run` failed at 17:07:42.674362 after 2.54 seconds
[0m17:07:42.674832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DACA1C4B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DACBA4F6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DACB9BFB50>]}
[0m17:07:42.675164 [debug] [MainThread]: Flushing usage events
[0m17:07:44.403436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:23.859498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023460CFE3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002345E99A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023461C63ED0>]}


============================== 17:09:23.863298 | cba3db98-40c0-4709-892d-172be04b9620 ==============================
[0m17:09:23.863298 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:09:23.864008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:09:24.016727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cba3db98-40c0-4709-892d-172be04b9620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023461E12D70>]}
[0m17:09:24.071759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cba3db98-40c0-4709-892d-172be04b9620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023461B53020>]}
[0m17:09:24.072627 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:09:24.282445 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:09:24.408524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:09:24.409373 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\transform_data.sql
[0m17:09:24.786846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cba3db98-40c0-4709-892d-172be04b9620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023463420950>]}
[0m17:09:24.858544 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:09:24.861647 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:09:24.878108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cba3db98-40c0-4709-892d-172be04b9620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023461C9FC50>]}
[0m17:09:24.878518 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 438 macros
[0m17:09:24.878981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cba3db98-40c0-4709-892d-172be04b9620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002346340FA10>]}
[0m17:09:24.880749 [info ] [MainThread]: 
[0m17:09:24.881336 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:24.881733 [info ] [MainThread]: 
[0m17:09:24.882460 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:09:24.886294 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m17:09:24.948532 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m17:09:24.948885 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m17:09:24.949150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:24.997355 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m17:09:24.998517 [debug] [ThreadPool]: On list_krisha_data: Close
[0m17:09:25.000152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m17:09:25.004740 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:09:25.005094 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m17:09:25.005354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:25.047879 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m17:09:25.048240 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:09:25.048521 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:09:25.055004 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m17:09:25.056244 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m17:09:25.056660 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m17:09:25.061069 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:25.061417 [debug] [MainThread]: On master: BEGIN
[0m17:09:25.061668 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:25.103619 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m17:09:25.103974 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:25.104294 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:09:25.112385 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m17:09:25.113503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cba3db98-40c0-4709-892d-172be04b9620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023463729710>]}
[0m17:09:25.113885 [debug] [MainThread]: On master: ROLLBACK
[0m17:09:25.114377 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:25.114649 [debug] [MainThread]: On master: BEGIN
[0m17:09:25.115283 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:09:25.115560 [debug] [MainThread]: On master: COMMIT
[0m17:09:25.115821 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:25.116070 [debug] [MainThread]: On master: COMMIT
[0m17:09:25.116497 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:09:25.116794 [debug] [MainThread]: On master: Close
[0m17:09:25.120565 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.raw_data
[0m17:09:25.121075 [info ] [Thread-1 (]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m17:09:25.121676 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m17:09:25.121982 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.raw_data
[0m17:09:25.131453 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m17:09:25.132320 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.raw_data
[0m17:09:25.222838 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m17:09:25.223960 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:09:25.224393 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m17:09:25.224749 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:09:25.270327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m17:09:25.270723 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:09:25.271033 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m17:09:25.283009 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.012 seconds
[0m17:09:25.291057 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:09:25.291442 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data" rename to "raw_data__dbt_backup"
[0m17:09:25.292504 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:09:25.294987 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:09:25.295321 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m17:09:25.296076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:09:25.310028 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:09:25.310434 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:09:25.310749 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:09:25.312592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:09:25.317724 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m17:09:25.321957 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:09:25.322303 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m17:09:25.327060 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m17:09:25.329254 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: Close
[0m17:09:25.330928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba3db98-40c0-4709-892d-172be04b9620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023463838110>]}
[0m17:09:25.331603 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.21s]
[0m17:09:25.332449 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.raw_data
[0m17:09:25.332846 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.transform_data
[0m17:09:25.333385 [info ] [Thread-1 (]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m17:09:25.333930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m17:09:25.334258 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.transform_data
[0m17:09:25.337575 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m17:09:25.338433 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.transform_data
[0m17:09:25.341310 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m17:09:25.342542 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:09:25.342908 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m17:09:25.343201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:25.386479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m17:09:25.386926 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:09:25.387290 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

with raw as (

    select *
    from "krisha_data"."public"."raw_flats"
    where price > 0

),

     prepared as (

         select
             row_number() over () as id,
    
    round(cast(price as numeric), -3)
 as rounded_price,
    address,
    
    case
        when lower(address) like '%дом%' then 'house'
        when lower(address) like '%квартира%' then 'flat'
        else 'unknown'
    end
 as property_type,
    
    to_date(created_at, 'YYYY-MM-DD')
 as standardized_date,
    
    case
        when extract(dow from to_date(created_at, 'YYYY-MM-DD')) in (0, 6) then true
        else false
    end
 as is_weekend,
    area,
    rooms,
    floor,
    total_floors,
    description
from raw

    )

select * from prepared
  );
  
[0m17:09:25.391038 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец "address" не существует
LINE 29:     address,
             ^

[0m17:09:25.391451 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: ROLLBACK
[0m17:09:25.392006 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: Close
[0m17:09:25.398094 [debug] [Thread-1 (]: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "address" не существует
  LINE 29:     address,
               ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:09:25.398569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba3db98-40c0-4709-892d-172be04b9620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023461E505D0>]}
[0m17:09:25.399137 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.transform_data .................... [[31mERROR[0m in 0.06s]
[0m17:09:25.399862 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.transform_data
[0m17:09:25.400462 [debug] [Thread-4 (]: Marking all children of 'model.krisha_data_pipeline.transform_data' to be skipped because of status 'error'.  Reason: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "address" не существует
  LINE 29:     address,
               ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql.
[0m17:09:25.401919 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.final_model
[0m17:09:25.402358 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.final_model ........................................ [[33mSKIP[0m]
[0m17:09:25.402873 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.final_model
[0m17:09:25.403882 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:25.404180 [debug] [MainThread]: On master: BEGIN
[0m17:09:25.404434 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:09:25.561118 [debug] [MainThread]: SQL status: BEGIN in 0.157 seconds
[0m17:09:25.561496 [debug] [MainThread]: On master: COMMIT
[0m17:09:25.561770 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:25.562026 [debug] [MainThread]: On master: COMMIT
[0m17:09:25.562469 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:09:25.562752 [debug] [MainThread]: On master: Close
[0m17:09:25.563188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:25.563443 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m17:09:25.563795 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m17:09:25.564035 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.transform_data' was properly closed.
[0m17:09:25.564361 [info ] [MainThread]: 
[0m17:09:25.564792 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m17:09:25.565813 [debug] [MainThread]: Command end result
[0m17:09:25.583998 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:09:25.585891 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:09:25.592215 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\run_results.json
[0m17:09:25.592543 [info ] [MainThread]: 
[0m17:09:25.593051 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:09:25.593512 [info ] [MainThread]: 
[0m17:09:25.594013 [error] [MainThread]:   Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "address" не существует
  LINE 29:     address,
               ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:09:25.594492 [info ] [MainThread]: 
[0m17:09:25.594921 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m17:09:25.595643 [debug] [MainThread]: Command `dbt run` failed at 17:09:25.595528 after 1.86 seconds
[0m17:09:25.596014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023463276E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023460D37D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023462F0CE50>]}
[0m17:09:25.596334 [debug] [MainThread]: Flushing usage events
[0m17:09:26.475294 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:19:20.224802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E38AD0E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E3889AA5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E38BC73ED0>]}


============================== 17:19:20.230905 | f16bbb90-b635-4f75-9ec2-686ade093992 ==============================
[0m17:19:20.230905 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:19:20.231669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:19:20.420821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f16bbb90-b635-4f75-9ec2-686ade093992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E38BE32D70>]}
[0m17:19:20.479886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f16bbb90-b635-4f75-9ec2-686ade093992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E38BB63020>]}
[0m17:19:20.480901 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:19:20.704192 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:19:20.851370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:19:20.852246 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\schema.yml
[0m17:19:20.852573 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\final_model.sql
[0m17:19:20.852869 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\transform_data.sql
[0m17:19:21.316336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f16bbb90-b635-4f75-9ec2-686ade093992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E38D02B450>]}
[0m17:19:21.384296 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:19:21.388206 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:19:21.418295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f16bbb90-b635-4f75-9ec2-686ade093992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E38BCAFC50>]}
[0m17:19:21.418712 [info ] [MainThread]: Found 3 models, 3 data tests, 1 source, 438 macros
[0m17:19:21.419112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f16bbb90-b635-4f75-9ec2-686ade093992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E38D531710>]}
[0m17:19:21.420683 [info ] [MainThread]: 
[0m17:19:21.421084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:19:21.421453 [info ] [MainThread]: 
[0m17:19:21.421999 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:19:21.425610 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m17:19:21.552064 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m17:19:21.552519 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m17:19:21.552873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:21.650835 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.098 seconds
[0m17:19:21.652113 [debug] [ThreadPool]: On list_krisha_data: Close
[0m17:19:21.653719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m17:19:21.658693 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:19:21.659095 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m17:19:21.659366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:21.822085 [debug] [ThreadPool]: SQL status: BEGIN in 0.163 seconds
[0m17:19:21.822450 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:19:21.822727 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:19:21.842276 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.019 seconds
[0m17:19:21.843743 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m17:19:21.844407 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m17:19:21.849565 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:21.849940 [debug] [MainThread]: On master: BEGIN
[0m17:19:21.850217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:19:21.894919 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m17:19:21.895297 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:21.895630 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:19:21.911503 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m17:19:21.912626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f16bbb90-b635-4f75-9ec2-686ade093992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E38D73A270>]}
[0m17:19:21.913039 [debug] [MainThread]: On master: ROLLBACK
[0m17:19:21.913535 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:21.913810 [debug] [MainThread]: On master: BEGIN
[0m17:19:21.914405 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:19:21.914681 [debug] [MainThread]: On master: COMMIT
[0m17:19:21.914945 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:21.915201 [debug] [MainThread]: On master: COMMIT
[0m17:19:21.915610 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:19:21.915894 [debug] [MainThread]: On master: Close
[0m17:19:21.922056 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.raw_data
[0m17:19:21.922594 [info ] [Thread-1 (]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m17:19:21.923249 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m17:19:21.923595 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.raw_data
[0m17:19:21.929868 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m17:19:21.930840 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.raw_data
[0m17:19:21.964873 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m17:19:21.966125 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:19:21.966475 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m17:19:21.966772 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:19:22.009466 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m17:19:22.009864 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:19:22.010175 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m17:19:22.031137 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.021 seconds
[0m17:19:22.039182 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:19:22.039559 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data" rename to "raw_data__dbt_backup"
[0m17:19:22.041176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:19:22.043805 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:19:22.044138 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m17:19:22.044825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:22.058819 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:19:22.059230 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:19:22.059542 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:19:22.061913 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:19:22.067254 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m17:19:22.071442 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:19:22.071800 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m17:19:22.081176 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m17:19:22.083483 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: Close
[0m17:19:22.085351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16bbb90-b635-4f75-9ec2-686ade093992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E38D34C590>]}
[0m17:19:22.086030 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.16s]
[0m17:19:22.086819 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.raw_data
[0m17:19:22.087407 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.transform_data
[0m17:19:22.088181 [info ] [Thread-1 (]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m17:19:22.088871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m17:19:22.089225 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.transform_data
[0m17:19:22.092433 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m17:19:22.093271 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.transform_data
[0m17:19:22.095669 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m17:19:22.096504 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:19:22.096831 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m17:19:22.097203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:22.140465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m17:19:22.140870 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:19:22.141216 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

with raw as (

    select *
    from "krisha_data"."public"."raw_flats"
    where price > 0

)

select
    row_number() over () as id,
    
    round(cast(price as numeric), -3)
 as rounded_price,
    address,
    
    case
        when lower(address) like '%дом%' then 'house'
        when lower(address) like '%квартира%' then 'flat'
        else 'unknown'
    end
 as property_type,
    
    to_date(created_at, 'YYYY-MM-DD')
 as standardized_date,
    
    case
        when extract(dow from to_date(created_at, 'YYYY-MM-DD')) in (0, 6) then true
        else false
    end
 as is_weekend,
    area,
    rooms,
    floor,
    total_floors,
    description
from raw
  );
  
[0m17:19:22.148872 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец "address" не существует
LINE 27:     address,
             ^

[0m17:19:22.149283 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: ROLLBACK
[0m17:19:22.149779 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: Close
[0m17:19:22.160872 [debug] [Thread-1 (]: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "address" не существует
  LINE 27:     address,
               ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:19:22.161360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f16bbb90-b635-4f75-9ec2-686ade093992', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E38D7B90D0>]}
[0m17:19:22.161907 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.transform_data .................... [[31mERROR[0m in 0.07s]
[0m17:19:22.162592 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.transform_data
[0m17:19:22.163130 [debug] [Thread-4 (]: Marking all children of 'model.krisha_data_pipeline.transform_data' to be skipped because of status 'error'.  Reason: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "address" не существует
  LINE 27:     address,
               ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql.
[0m17:19:22.164194 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.final_model
[0m17:19:22.164602 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.final_model ........................................ [[33mSKIP[0m]
[0m17:19:22.165127 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.final_model
[0m17:19:22.166142 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:22.166474 [debug] [MainThread]: On master: BEGIN
[0m17:19:22.166736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:19:22.210995 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m17:19:22.211378 [debug] [MainThread]: On master: COMMIT
[0m17:19:22.211658 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:22.211914 [debug] [MainThread]: On master: COMMIT
[0m17:19:22.212361 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:19:22.212647 [debug] [MainThread]: On master: Close
[0m17:19:22.213068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:22.213343 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m17:19:22.213702 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m17:19:22.214049 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.transform_data' was properly closed.
[0m17:19:22.214845 [info ] [MainThread]: 
[0m17:19:22.215322 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m17:19:22.216373 [debug] [MainThread]: Command end result
[0m17:19:22.233475 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:19:22.236070 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:19:22.241944 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\run_results.json
[0m17:19:22.242286 [info ] [MainThread]: 
[0m17:19:22.242754 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:19:22.243201 [info ] [MainThread]: 
[0m17:19:22.243709 [error] [MainThread]:   Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "address" не существует
  LINE 27:     address,
               ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:19:22.244166 [info ] [MainThread]: 
[0m17:19:22.244581 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m17:19:22.245343 [debug] [MainThread]: Command `dbt run` failed at 17:19:22.245228 after 2.15 seconds
[0m17:19:22.245690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E38D2445F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E38AD47D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E38D80DFD0>]}
[0m17:19:22.246016 [debug] [MainThread]: Flushing usage events
[0m17:19:23.208115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:59.018413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30FB563C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30D80A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B310ABFED0>]}


============================== 17:27:59.025732 | 40ea346a-96fb-47f0-b269-bdd84e17bc01 ==============================
[0m17:27:59.025732 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:27:59.026455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:27:59.254090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40ea346a-96fb-47f0-b269-bdd84e17bc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B310C72D70>]}
[0m17:27:59.313905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40ea346a-96fb-47f0-b269-bdd84e17bc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3109B3020>]}
[0m17:27:59.314896 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:27:59.560536 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:27:59.708620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m17:27:59.709216 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\transform_data.sql
[0m17:27:59.709595 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://macros\standardize_date.sql
[0m17:27:59.709940 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://macros\detect_property_type.sql
[0m17:27:59.710287 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://macros\is_weekend.sql
[0m17:28:00.165641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40ea346a-96fb-47f0-b269-bdd84e17bc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B311EA7E50>]}
[0m17:28:00.242985 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:28:00.258929 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:28:00.303084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40ea346a-96fb-47f0-b269-bdd84e17bc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B30FBF9130>]}
[0m17:28:00.303755 [info ] [MainThread]: Found 3 models, 3 data tests, 1 source, 438 macros
[0m17:28:00.304392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40ea346a-96fb-47f0-b269-bdd84e17bc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B31226BBD0>]}
[0m17:28:00.306425 [info ] [MainThread]: 
[0m17:28:00.306978 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:28:00.307469 [info ] [MainThread]: 
[0m17:28:00.308091 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:28:00.313225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m17:28:00.402275 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m17:28:00.402781 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m17:28:00.403063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:00.609445 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.206 seconds
[0m17:28:00.610987 [debug] [ThreadPool]: On list_krisha_data: Close
[0m17:28:00.612688 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m17:28:00.618660 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:28:00.619046 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m17:28:00.619308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:00.668944 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m17:28:00.669334 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:28:00.669623 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:28:00.683642 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m17:28:00.684975 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m17:28:00.685752 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m17:28:00.690944 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:00.691390 [debug] [MainThread]: On master: BEGIN
[0m17:28:00.691749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:28:00.738517 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m17:28:00.738881 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:00.739207 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:28:00.754833 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m17:28:00.756044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40ea346a-96fb-47f0-b269-bdd84e17bc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B31257D4A0>]}
[0m17:28:00.756457 [debug] [MainThread]: On master: ROLLBACK
[0m17:28:00.756976 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:00.757268 [debug] [MainThread]: On master: BEGIN
[0m17:28:00.757772 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:28:00.758061 [debug] [MainThread]: On master: COMMIT
[0m17:28:00.758327 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:00.758592 [debug] [MainThread]: On master: COMMIT
[0m17:28:00.758946 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:28:00.759222 [debug] [MainThread]: On master: Close
[0m17:28:00.764706 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.raw_data
[0m17:28:00.765250 [info ] [Thread-1 (]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m17:28:00.765826 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m17:28:00.766178 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.raw_data
[0m17:28:00.778242 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m17:28:00.779244 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.raw_data
[0m17:28:00.893094 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m17:28:00.894853 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:28:00.895355 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m17:28:00.895757 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:28:00.950651 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m17:28:00.951085 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:28:00.951424 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m17:28:00.976644 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.025 seconds
[0m17:28:00.986459 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:28:00.986889 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data" rename to "raw_data__dbt_backup"
[0m17:28:00.988315 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:28:00.992160 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:28:00.992623 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m17:28:00.993672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:28:01.011656 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:28:01.013409 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:28:01.014163 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:28:01.020177 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:28:01.028437 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m17:28:01.034200 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:28:01.034775 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m17:28:01.047352 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m17:28:01.050006 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: Close
[0m17:28:01.052309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40ea346a-96fb-47f0-b269-bdd84e17bc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3122DF890>]}
[0m17:28:01.053837 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.28s]
[0m17:28:01.054847 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.raw_data
[0m17:28:01.055293 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.transform_data
[0m17:28:01.055800 [info ] [Thread-1 (]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m17:28:01.056487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m17:28:01.056970 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.transform_data
[0m17:28:01.062190 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m17:28:01.063737 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.transform_data
[0m17:28:01.067583 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m17:28:01.069867 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:28:01.070328 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m17:28:01.070703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:01.127657 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m17:28:01.128060 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:28:01.128551 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

with raw as (
    select *
    from "krisha_data"."public"."raw_flats"
    where price > 0
)

select
    row_number() over () as id,
    
    round(cast(price as numeric), -3)
 as rounded_price,
    city as address,  -- Заменил 'address' на 'city'
    
    case
        when lower(address) like '%дом%' then 'house'
        when lower(address) like '%квартира%' then 'flat'
        else 'unknown'
end
 as property_type,  -- Если этот макрос использует адрес, возможно, нужно будет обновить его
    
    to_date(created_at, 'YYYY-MM-DD')
 as standardized_date,
    
    case
        when extract(dow from to_date(created_at, 'YYYY-MM-DD')) in (0, 6) then true
        else false
end
 as is_weekend,
    sqm as area,  -- Заменил 'area' на 'sqm'
    rooms,
    floor,
    total_floors,
    description
from raw
  );
  
[0m17:28:01.136832 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец "address" не существует
LINE 28:         when lower(address) like '%дом%' then 'house'
                            ^

[0m17:28:01.137328 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: ROLLBACK
[0m17:28:01.137961 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: Close
[0m17:28:01.150373 [debug] [Thread-1 (]: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "address" не существует
  LINE 28:         when lower(address) like '%дом%' then 'house'
                              ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:28:01.150941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40ea346a-96fb-47f0-b269-bdd84e17bc01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3122B7CD0>]}
[0m17:28:01.151529 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.transform_data .................... [[31mERROR[0m in 0.09s]
[0m17:28:01.152342 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.transform_data
[0m17:28:01.152961 [debug] [Thread-4 (]: Marking all children of 'model.krisha_data_pipeline.transform_data' to be skipped because of status 'error'.  Reason: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "address" не существует
  LINE 28:         when lower(address) like '%дом%' then 'house'
                              ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql.
[0m17:28:01.154180 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.final_model
[0m17:28:01.154586 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.final_model ........................................ [[33mSKIP[0m]
[0m17:28:01.155159 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.final_model
[0m17:28:01.156301 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:01.156684 [debug] [MainThread]: On master: BEGIN
[0m17:28:01.156974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:28:01.214216 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m17:28:01.214666 [debug] [MainThread]: On master: COMMIT
[0m17:28:01.214993 [debug] [MainThread]: Using postgres connection "master"
[0m17:28:01.215289 [debug] [MainThread]: On master: COMMIT
[0m17:28:01.215852 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:28:01.216534 [debug] [MainThread]: On master: Close
[0m17:28:01.217426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:01.217923 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m17:28:01.218409 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m17:28:01.218949 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.transform_data' was properly closed.
[0m17:28:01.219874 [info ] [MainThread]: 
[0m17:28:01.221283 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m17:28:01.223401 [debug] [MainThread]: Command end result
[0m17:28:01.252726 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:28:01.257259 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:28:01.264755 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\run_results.json
[0m17:28:01.265172 [info ] [MainThread]: 
[0m17:28:01.265897 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:28:01.266436 [info ] [MainThread]: 
[0m17:28:01.267127 [error] [MainThread]:   Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "address" не существует
  LINE 28:         when lower(address) like '%дом%' then 'house'
                              ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:28:01.268292 [info ] [MainThread]: 
[0m17:28:01.268968 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m17:28:01.269972 [debug] [MainThread]: Command `dbt run` failed at 17:28:01.269830 after 2.41 seconds
[0m17:28:01.270377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3120B2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B312635C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3122E94D0>]}
[0m17:28:01.270766 [debug] [MainThread]: Flushing usage events
[0m17:28:02.193179 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:54.976659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532D36E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532AFEE5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532E2D3ED0>]}


============================== 17:30:54.980561 | 9b808814-e174-4d98-83fd-8791f9cd567a ==============================
[0m17:30:54.980561 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:30:54.981260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:30:55.132029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b808814-e174-4d98-83fd-8791f9cd567a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532E482D70>]}
[0m17:30:55.187394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b808814-e174-4d98-83fd-8791f9cd567a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532E1C3020>]}
[0m17:30:55.188249 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:30:55.407718 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:30:55.532123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:30:55.532815 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://macros\detect_property_type.sql
[0m17:30:55.533127 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\transform_data.sql
[0m17:30:55.918212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b808814-e174-4d98-83fd-8791f9cd567a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532F6E7D50>]}
[0m17:30:55.986808 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:30:55.989717 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:30:56.007177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b808814-e174-4d98-83fd-8791f9cd567a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532D409130>]}
[0m17:30:56.007719 [info ] [MainThread]: Found 3 models, 3 data tests, 1 source, 438 macros
[0m17:30:56.008312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b808814-e174-4d98-83fd-8791f9cd567a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532FAABD90>]}
[0m17:30:56.010210 [info ] [MainThread]: 
[0m17:30:56.010683 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:30:56.011063 [info ] [MainThread]: 
[0m17:30:56.011590 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:30:56.015295 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m17:30:56.090558 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m17:30:56.091011 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m17:30:56.091297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:56.140376 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m17:30:56.141629 [debug] [ThreadPool]: On list_krisha_data: Close
[0m17:30:56.143374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m17:30:56.148631 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:30:56.149023 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m17:30:56.149295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:56.304230 [debug] [ThreadPool]: SQL status: BEGIN in 0.155 seconds
[0m17:30:56.304617 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:30:56.304917 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:30:56.312214 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m17:30:56.313833 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m17:30:56.314481 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m17:30:56.319815 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:56.320225 [debug] [MainThread]: On master: BEGIN
[0m17:30:56.320495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:56.368585 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m17:30:56.369174 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:56.369654 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:30:56.377290 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m17:30:56.378535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b808814-e174-4d98-83fd-8791f9cd567a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532FDB5640>]}
[0m17:30:56.379002 [debug] [MainThread]: On master: ROLLBACK
[0m17:30:56.380044 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:56.380329 [debug] [MainThread]: On master: BEGIN
[0m17:30:56.380887 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:30:56.381189 [debug] [MainThread]: On master: COMMIT
[0m17:30:56.381464 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:56.381729 [debug] [MainThread]: On master: COMMIT
[0m17:30:56.382215 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:30:56.382520 [debug] [MainThread]: On master: Close
[0m17:30:56.386635 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.raw_data
[0m17:30:56.387422 [info ] [Thread-1 (]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m17:30:56.388216 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m17:30:56.388584 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.raw_data
[0m17:30:56.399629 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m17:30:56.400606 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.raw_data
[0m17:30:56.508931 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m17:30:56.510010 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:30:56.510421 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m17:30:56.510783 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:30:56.559578 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m17:30:56.560029 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:30:56.560413 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m17:30:56.571378 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.011 seconds
[0m17:30:56.579606 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:30:56.579991 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data" rename to "raw_data__dbt_backup"
[0m17:30:56.580834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:30:56.583526 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:30:56.583881 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m17:30:56.584624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:30:56.600309 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:30:56.600791 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:30:56.601172 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:30:56.602878 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:30:56.608258 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m17:30:56.612824 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:30:56.613223 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m17:30:56.616995 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:30:56.619313 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: Close
[0m17:30:56.621386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b808814-e174-4d98-83fd-8791f9cd567a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532FB2B890>]}
[0m17:30:56.622232 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.23s]
[0m17:30:56.623048 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.raw_data
[0m17:30:56.623493 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.transform_data
[0m17:30:56.624018 [info ] [Thread-1 (]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m17:30:56.624587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m17:30:56.625107 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.transform_data
[0m17:30:56.628716 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m17:30:56.629916 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.transform_data
[0m17:30:56.634076 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m17:30:56.635509 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:30:56.636174 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m17:30:56.636916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:56.683115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m17:30:56.683562 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:30:56.683926 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

with raw as (
    select *
    from "krisha_data"."public"."raw_flats"
    where price > 0
)

select
    row_number() over () as id,
    
    round(cast(price as numeric), -3)
 as rounded_price,
    city as address,  -- Заменил 'address' на 'city'
    
    case
        when lower(city) like '%дом%' then 'house'
        when lower(city) like '%квартира%' then 'flat'
        else 'unknown'
end
 as property_type,  -- Если этот макрос использует адрес, возможно, нужно будет обновить его
    
    to_date(created_at, 'YYYY-MM-DD')
 as standardized_date,
    
    case
        when extract(dow from to_date(created_at, 'YYYY-MM-DD')) in (0, 6) then true
        else false
end
 as is_weekend,
    sqm as area,  -- Заменил 'area' на 'sqm'
    rooms,
    floor,
    total_floors,
    description
from raw
  );
  
[0m17:30:56.685995 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец "created_at" не существует
LINE 34:     to_date(created_at, 'YYYY-MM-DD')
                     ^

[0m17:30:56.686423 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: ROLLBACK
[0m17:30:56.687001 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: Close
[0m17:30:56.693571 [debug] [Thread-1 (]: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "created_at" не существует
  LINE 34:     to_date(created_at, 'YYYY-MM-DD')
                       ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:30:56.694170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b808814-e174-4d98-83fd-8791f9cd567a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532F8A0520>]}
[0m17:30:56.694823 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.transform_data .................... [[31mERROR[0m in 0.07s]
[0m17:30:56.695563 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.transform_data
[0m17:30:56.696138 [debug] [Thread-4 (]: Marking all children of 'model.krisha_data_pipeline.transform_data' to be skipped because of status 'error'.  Reason: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "created_at" не существует
  LINE 34:     to_date(created_at, 'YYYY-MM-DD')
                       ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql.
[0m17:30:56.697239 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.final_model
[0m17:30:56.697612 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.final_model ........................................ [[33mSKIP[0m]
[0m17:30:56.698140 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.final_model
[0m17:30:56.699164 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:56.699473 [debug] [MainThread]: On master: BEGIN
[0m17:30:56.699740 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:30:56.748985 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m17:30:56.749365 [debug] [MainThread]: On master: COMMIT
[0m17:30:56.749751 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:56.750027 [debug] [MainThread]: On master: COMMIT
[0m17:30:56.750496 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:30:56.750800 [debug] [MainThread]: On master: Close
[0m17:30:56.751259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:56.751535 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m17:30:56.751874 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m17:30:56.752140 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.transform_data' was properly closed.
[0m17:30:56.752510 [info ] [MainThread]: 
[0m17:30:56.753012 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m17:30:56.754092 [debug] [MainThread]: Command end result
[0m17:30:56.775675 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:30:56.778423 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:30:56.786040 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\run_results.json
[0m17:30:56.786547 [info ] [MainThread]: 
[0m17:30:56.787354 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:30:56.787946 [info ] [MainThread]: 
[0m17:30:56.788582 [error] [MainThread]:   Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "created_at" не существует
  LINE 34:     to_date(created_at, 'YYYY-MM-DD')
                       ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:30:56.789173 [info ] [MainThread]: 
[0m17:30:56.789718 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m17:30:56.790638 [debug] [MainThread]: Command `dbt run` failed at 17:30:56.790493 after 1.93 seconds
[0m17:30:56.791046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532F90B750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532D3A7D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532FABA5D0>]}
[0m17:30:56.791476 [debug] [MainThread]: Flushing usage events
[0m17:30:57.691150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:35:22.476077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1A23E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD17EF25D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1B1A3ED0>]}


============================== 17:35:22.481249 | 7d0f37f8-d00b-4559-8ceb-6fd9484dcf6a ==============================
[0m17:35:22.481249 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:35:22.482088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:35:22.674248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d0f37f8-d00b-4559-8ceb-6fd9484dcf6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1B362D70>]}
[0m17:35:22.730725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d0f37f8-d00b-4559-8ceb-6fd9484dcf6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1B093020>]}
[0m17:35:22.731603 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:35:22.968963 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:35:23.109693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:35:23.110245 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\transform_data.sql
[0m17:35:23.499800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d0f37f8-d00b-4559-8ceb-6fd9484dcf6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1C557D50>]}
[0m17:35:23.578896 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:35:23.582248 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:35:23.607257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d0f37f8-d00b-4559-8ceb-6fd9484dcf6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1A2D9130>]}
[0m17:35:23.607671 [info ] [MainThread]: Found 3 models, 3 data tests, 1 source, 438 macros
[0m17:35:23.608203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d0f37f8-d00b-4559-8ceb-6fd9484dcf6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1C91FA10>]}
[0m17:35:23.610108 [info ] [MainThread]: 
[0m17:35:23.610534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:35:23.610900 [info ] [MainThread]: 
[0m17:35:23.611464 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:35:23.614909 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m17:35:23.682071 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m17:35:23.682428 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m17:35:23.682689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:23.760160 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.077 seconds
[0m17:35:23.761342 [debug] [ThreadPool]: On list_krisha_data: Close
[0m17:35:23.762862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m17:35:23.768407 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:35:23.768772 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m17:35:23.769035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:23.926187 [debug] [ThreadPool]: SQL status: BEGIN in 0.157 seconds
[0m17:35:23.926564 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:35:23.926839 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:35:23.941293 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m17:35:23.942492 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m17:35:23.943044 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m17:35:23.947506 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:23.947832 [debug] [MainThread]: On master: BEGIN
[0m17:35:23.948078 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:23.991874 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m17:35:23.992222 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:23.992535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:35:24.008034 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m17:35:24.009096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d0f37f8-d00b-4559-8ceb-6fd9484dcf6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1CC3D4A0>]}
[0m17:35:24.009588 [debug] [MainThread]: On master: ROLLBACK
[0m17:35:24.010026 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:24.010286 [debug] [MainThread]: On master: BEGIN
[0m17:35:24.010859 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:35:24.011148 [debug] [MainThread]: On master: COMMIT
[0m17:35:24.011410 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:24.011656 [debug] [MainThread]: On master: COMMIT
[0m17:35:24.011990 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:35:24.012254 [debug] [MainThread]: On master: Close
[0m17:35:24.016665 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.raw_data
[0m17:35:24.017178 [info ] [Thread-1 (]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m17:35:24.017815 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m17:35:24.018130 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.raw_data
[0m17:35:24.027244 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m17:35:24.028194 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.raw_data
[0m17:35:24.122158 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m17:35:24.123352 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:35:24.123780 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m17:35:24.124168 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:35:24.171030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m17:35:24.171420 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:35:24.171729 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m17:35:24.207851 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.036 seconds
[0m17:35:24.215898 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:35:24.216267 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data" rename to "raw_data__dbt_backup"
[0m17:35:24.217844 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:35:24.220416 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:35:24.220749 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m17:35:24.221442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:35:24.235399 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:35:24.235825 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:35:24.236129 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:35:24.238950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:35:24.244355 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m17:35:24.248628 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:35:24.248959 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m17:35:24.260637 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m17:35:24.262897 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: Close
[0m17:35:24.264878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0f37f8-d00b-4559-8ceb-6fd9484dcf6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1C88C1D0>]}
[0m17:35:24.265584 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.25s]
[0m17:35:24.266360 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.raw_data
[0m17:35:24.266758 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.transform_data
[0m17:35:24.267299 [info ] [Thread-1 (]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m17:35:24.267857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m17:35:24.268190 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.transform_data
[0m17:35:24.271510 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m17:35:24.272389 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.transform_data
[0m17:35:24.276035 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m17:35:24.277606 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:35:24.278162 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m17:35:24.278599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:24.328351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m17:35:24.328759 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:35:24.329110 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

with raw as (
    select *
    from "krisha_data"."public"."raw_flats"
    where price > 0
)

select
    row_number() over () as id,
    
    round(cast(price as numeric), -3)
 as rounded_price,
    city as address,
    
    case
        when lower(city) like '%дом%' then 'house'
        when lower(city) like '%квартира%' then 'flat'
        else 'unknown'
end
 as property_type,
    
    to_date(date, 'YYYY-MM-DD')
 as standardized_date,
    
    case
        when extract(dow from to_date(date, 'YYYY-MM-DD')) in (0, 6) then true
        else false
end
 as is_weekend,
    sqm as area,
    rooms,
    name, -- название квартиры
    year_of_est -- год постройки
from raw
  );
  
[0m17:35:24.350262 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверное значение "а" для "MM"
DETAIL:  Значение должно быть целым числом.

[0m17:35:24.350689 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: ROLLBACK
[0m17:35:24.351311 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: Close
[0m17:35:24.361762 [debug] [Thread-1 (]: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  неверное значение "а" для "MM"
  DETAIL:  Значение должно быть целым числом.
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:35:24.362318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0f37f8-d00b-4559-8ceb-6fd9484dcf6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1CDC0680>]}
[0m17:35:24.362890 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.transform_data .................... [[31mERROR[0m in 0.09s]
[0m17:35:24.363564 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.transform_data
[0m17:35:24.364079 [debug] [Thread-4 (]: Marking all children of 'model.krisha_data_pipeline.transform_data' to be skipped because of status 'error'.  Reason: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  неверное значение "а" для "MM"
  DETAIL:  Значение должно быть целым числом.
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql.
[0m17:35:24.365205 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.final_model
[0m17:35:24.365740 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.final_model ........................................ [[33mSKIP[0m]
[0m17:35:24.366396 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.final_model
[0m17:35:24.368032 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:24.368611 [debug] [MainThread]: On master: BEGIN
[0m17:35:24.369088 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:24.413309 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m17:35:24.413670 [debug] [MainThread]: On master: COMMIT
[0m17:35:24.413947 [debug] [MainThread]: Using postgres connection "master"
[0m17:35:24.414200 [debug] [MainThread]: On master: COMMIT
[0m17:35:24.414646 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:35:24.414930 [debug] [MainThread]: On master: Close
[0m17:35:24.415350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:24.415600 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m17:35:24.415868 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m17:35:24.416120 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.transform_data' was properly closed.
[0m17:35:24.416464 [info ] [MainThread]: 
[0m17:35:24.417007 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m17:35:24.418096 [debug] [MainThread]: Command end result
[0m17:35:24.436197 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:35:24.438275 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:35:24.443494 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\run_results.json
[0m17:35:24.443828 [info ] [MainThread]: 
[0m17:35:24.444334 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:35:24.444824 [info ] [MainThread]: 
[0m17:35:24.445344 [error] [MainThread]:   Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  неверное значение "а" для "MM"
  DETAIL:  Значение должно быть целым числом.
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:35:24.445821 [info ] [MainThread]: 
[0m17:35:24.446255 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m17:35:24.446984 [debug] [MainThread]: Command `dbt run` failed at 17:35:24.446875 after 2.17 seconds
[0m17:35:24.447336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1C776A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD1A277D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD19FD2CD0>]}
[0m17:35:24.447814 [debug] [MainThread]: Flushing usage events
[0m17:35:25.381127 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:36:51.057466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AB9C1E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AB78BA5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ABAB83ED0>]}


============================== 17:36:51.061259 | f2a47860-7527-4237-b5f4-a6ed867ada43 ==============================
[0m17:36:51.061259 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:36:51.061856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:36:51.215574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2a47860-7527-4237-b5f4-a6ed867ada43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ABADA2D70>]}
[0m17:36:51.271194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2a47860-7527-4237-b5f4-a6ed867ada43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ABAA73020>]}
[0m17:36:51.272127 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:36:51.506044 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:36:51.628759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:36:51.629409 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://macros\standardize_date.sql
[0m17:36:52.021427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2a47860-7527-4237-b5f4-a6ed867ada43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ABBF97D50>]}
[0m17:36:52.090210 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:36:52.093154 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:36:52.109476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2a47860-7527-4237-b5f4-a6ed867ada43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AB9CB9130>]}
[0m17:36:52.109891 [info ] [MainThread]: Found 3 models, 3 data tests, 1 source, 438 macros
[0m17:36:52.110349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2a47860-7527-4237-b5f4-a6ed867ada43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ABC35BD90>]}
[0m17:36:52.111942 [info ] [MainThread]: 
[0m17:36:52.112386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:36:52.112877 [info ] [MainThread]: 
[0m17:36:52.113420 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:36:52.116988 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m17:36:52.181676 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m17:36:52.182035 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m17:36:52.182300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:52.231681 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m17:36:52.232860 [debug] [ThreadPool]: On list_krisha_data: Close
[0m17:36:52.234679 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m17:36:52.239324 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:36:52.239650 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m17:36:52.239900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:52.283560 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m17:36:52.283960 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:36:52.284297 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:36:52.290940 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m17:36:52.292151 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m17:36:52.292642 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m17:36:52.297831 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:52.298187 [debug] [MainThread]: On master: BEGIN
[0m17:36:52.298456 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:36:52.340462 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m17:36:52.340817 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:52.341146 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:36:52.348738 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m17:36:52.349822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2a47860-7527-4237-b5f4-a6ed867ada43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ABC665640>]}
[0m17:36:52.350209 [debug] [MainThread]: On master: ROLLBACK
[0m17:36:52.350665 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:52.350928 [debug] [MainThread]: On master: BEGIN
[0m17:36:52.351466 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:36:52.351747 [debug] [MainThread]: On master: COMMIT
[0m17:36:52.352007 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:52.352253 [debug] [MainThread]: On master: COMMIT
[0m17:36:52.352635 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:36:52.352915 [debug] [MainThread]: On master: Close
[0m17:36:52.356723 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.raw_data
[0m17:36:52.357246 [info ] [Thread-1 (]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m17:36:52.357857 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m17:36:52.358243 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.raw_data
[0m17:36:52.367508 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m17:36:52.368400 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.raw_data
[0m17:36:52.457964 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m17:36:52.459096 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:36:52.459524 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m17:36:52.459879 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:36:52.505452 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m17:36:52.505844 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:36:52.506156 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m17:36:52.514805 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.008 seconds
[0m17:36:52.522954 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:36:52.523327 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data" rename to "raw_data__dbt_backup"
[0m17:36:52.523987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:36:52.526502 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:36:52.526836 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m17:36:52.527520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:36:52.541360 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:36:52.541772 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:36:52.542088 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:36:52.544654 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:36:52.549931 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m17:36:52.554089 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:36:52.554433 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m17:36:52.557838 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:36:52.560040 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: Close
[0m17:36:52.561798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a47860-7527-4237-b5f4-a6ed867ada43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ABC3DF890>]}
[0m17:36:52.562469 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.20s]
[0m17:36:52.563463 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.raw_data
[0m17:36:52.564023 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.transform_data
[0m17:36:52.564594 [info ] [Thread-1 (]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m17:36:52.565197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m17:36:52.565702 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.transform_data
[0m17:36:52.569074 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m17:36:52.569908 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.transform_data
[0m17:36:52.572276 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m17:36:52.573016 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:36:52.573338 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m17:36:52.573632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:52.617531 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m17:36:52.617922 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:36:52.618271 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

with raw as (
    select *
    from "krisha_data"."public"."raw_flats"
    where price > 0
)

select
    row_number() over () as id,
    
    round(cast(price as numeric), -3)
 as rounded_price,
    city as address,
    
    case
        when lower(city) like '%дом%' then 'house'
        when lower(city) like '%квартира%' then 'flat'
        else 'unknown'
end
 as property_type,
    
    case
        when date ~ '^\d{4}-\d{2}-\d{2}$' then to_date(date, 'YYYY-MM-DD')
        else null
end
 as standardized_date,
    
    case
        when extract(dow from to_date(date, 'YYYY-MM-DD')) in (0, 6) then true
        else false
end
 as is_weekend,
    sqm as area,
    rooms,
    name, -- название квартиры
    year_of_est -- год постройки
from raw
  );
  
[0m17:36:52.630032 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверное значение "а" для "MM"
DETAIL:  Значение должно быть целым числом.

[0m17:36:52.630445 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: ROLLBACK
[0m17:36:52.630958 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: Close
[0m17:36:52.636796 [debug] [Thread-1 (]: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  неверное значение "а" для "MM"
  DETAIL:  Значение должно быть целым числом.
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:36:52.637278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a47860-7527-4237-b5f4-a6ed867ada43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ABC460520>]}
[0m17:36:52.637816 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.transform_data .................... [[31mERROR[0m in 0.07s]
[0m17:36:52.638504 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.transform_data
[0m17:36:52.639052 [debug] [Thread-4 (]: Marking all children of 'model.krisha_data_pipeline.transform_data' to be skipped because of status 'error'.  Reason: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  неверное значение "а" для "MM"
  DETAIL:  Значение должно быть целым числом.
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql.
[0m17:36:52.640100 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.final_model
[0m17:36:52.640452 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.final_model ........................................ [[33mSKIP[0m]
[0m17:36:52.641007 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.final_model
[0m17:36:52.641999 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:52.642284 [debug] [MainThread]: On master: BEGIN
[0m17:36:52.642546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:36:52.807215 [debug] [MainThread]: SQL status: BEGIN in 0.165 seconds
[0m17:36:52.807586 [debug] [MainThread]: On master: COMMIT
[0m17:36:52.807857 [debug] [MainThread]: Using postgres connection "master"
[0m17:36:52.808108 [debug] [MainThread]: On master: COMMIT
[0m17:36:52.808639 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:36:52.808924 [debug] [MainThread]: On master: Close
[0m17:36:52.809411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:52.809669 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m17:36:52.810069 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m17:36:52.810496 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.transform_data' was properly closed.
[0m17:36:52.810964 [info ] [MainThread]: 
[0m17:36:52.811475 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m17:36:52.812497 [debug] [MainThread]: Command end result
[0m17:36:52.832080 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:36:52.833925 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:36:52.839613 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\run_results.json
[0m17:36:52.839953 [info ] [MainThread]: 
[0m17:36:52.840454 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:36:52.840905 [info ] [MainThread]: 
[0m17:36:52.841413 [error] [MainThread]:   Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  неверное значение "а" для "MM"
  DETAIL:  Значение должно быть целым числом.
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:36:52.841890 [info ] [MainThread]: 
[0m17:36:52.842329 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m17:36:52.843067 [debug] [MainThread]: Command `dbt run` failed at 17:36:52.842954 after 1.91 seconds
[0m17:36:52.843404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ABC27DDB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013AB9C57D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013ABC36F350>]}
[0m17:36:52.843807 [debug] [MainThread]: Flushing usage events
[0m17:36:53.762614 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:07.644110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2958CE3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B29356A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B29682FED0>]}


============================== 17:38:07.648087 | 7b07f1ba-d4a1-4c03-be57-510d950b9c75 ==============================
[0m17:38:07.648087 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:38:07.648857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:07.762938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b07f1ba-d4a1-4c03-be57-510d950b9c75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B295CDBCE0>]}
[0m17:38:07.783849 [debug] [MainThread]: Command `dbt clean` succeeded at 17:38:07.783708 after 0.28 seconds
[0m17:38:07.784251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B296721590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2967219D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2969D8950>]}
[0m17:38:07.784631 [debug] [MainThread]: Flushing usage events
[0m17:38:08.676441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:14.013528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002271F66E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002271D2FE5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227205D3ED0>]}


============================== 17:38:14.017298 | 8f00fac8-dc0e-4204-96db-c52723fac473 ==============================
[0m17:38:14.017298 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:38:14.017932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:38:14.170112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f00fac8-dc0e-4204-96db-c52723fac473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022720782D70>]}
[0m17:38:14.226955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f00fac8-dc0e-4204-96db-c52723fac473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227204C3020>]}
[0m17:38:14.227869 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:38:14.445773 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:38:14.446746 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:38:14.447206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8f00fac8-dc0e-4204-96db-c52723fac473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022720446450>]}
[0m17:38:15.599837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f00fac8-dc0e-4204-96db-c52723fac473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022721A6AC60>]}
[0m17:38:15.682164 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:38:15.685875 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:38:15.703124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f00fac8-dc0e-4204-96db-c52723fac473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022720794AD0>]}
[0m17:38:15.703586 [info ] [MainThread]: Found 3 models, 3 data tests, 1 source, 438 macros
[0m17:38:15.704032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f00fac8-dc0e-4204-96db-c52723fac473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022721AC0530>]}
[0m17:38:15.705725 [info ] [MainThread]: 
[0m17:38:15.706183 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:15.706577 [info ] [MainThread]: 
[0m17:38:15.707182 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:38:15.710727 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m17:38:15.774717 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m17:38:15.775100 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m17:38:15.775373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:15.824297 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m17:38:15.825743 [debug] [ThreadPool]: On list_krisha_data: Close
[0m17:38:15.827647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m17:38:15.832484 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:38:15.832888 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m17:38:15.833217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:15.876321 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m17:38:15.876683 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:38:15.876970 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:38:15.882664 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m17:38:15.883899 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m17:38:15.884361 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m17:38:15.889026 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:15.889387 [debug] [MainThread]: On master: BEGIN
[0m17:38:15.889701 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:15.934152 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m17:38:15.934508 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:15.934835 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:38:15.942400 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m17:38:15.943518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f00fac8-dc0e-4204-96db-c52723fac473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227207C2E10>]}
[0m17:38:15.943911 [debug] [MainThread]: On master: ROLLBACK
[0m17:38:15.944447 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:15.944750 [debug] [MainThread]: On master: BEGIN
[0m17:38:15.945331 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:38:15.945622 [debug] [MainThread]: On master: COMMIT
[0m17:38:15.945890 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:15.946144 [debug] [MainThread]: On master: COMMIT
[0m17:38:15.946508 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:38:15.946784 [debug] [MainThread]: On master: Close
[0m17:38:15.950584 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.raw_data
[0m17:38:15.951136 [info ] [Thread-1 (]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m17:38:15.951845 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m17:38:15.952196 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.raw_data
[0m17:38:15.959199 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m17:38:15.960982 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.raw_data
[0m17:38:15.998260 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m17:38:16.000096 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:38:16.000510 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m17:38:16.000877 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:38:16.042860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m17:38:16.043260 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:38:16.043685 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m17:38:16.051242 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.007 seconds
[0m17:38:16.059255 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:38:16.059636 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data" rename to "raw_data__dbt_backup"
[0m17:38:16.060392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:38:16.062803 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:38:16.063149 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m17:38:16.063899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:38:16.077991 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:38:16.078399 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:38:16.078719 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:38:16.080499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:38:16.085745 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m17:38:16.089939 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:38:16.090295 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m17:38:16.093778 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:38:16.095980 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: Close
[0m17:38:16.097961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f00fac8-dc0e-4204-96db-c52723fac473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022721DE10D0>]}
[0m17:38:16.098633 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.14s]
[0m17:38:16.099590 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.raw_data
[0m17:38:16.100234 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.transform_data
[0m17:38:16.101037 [info ] [Thread-1 (]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m17:38:16.101752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m17:38:16.102111 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.transform_data
[0m17:38:16.105992 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m17:38:16.107056 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.transform_data
[0m17:38:16.109724 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m17:38:16.110787 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:38:16.111186 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m17:38:16.111493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:16.268766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.157 seconds
[0m17:38:16.269204 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:38:16.269563 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

with raw as (
    select *
    from "krisha_data"."public"."raw_flats"
    where price > 0
)

select
    row_number() over () as id,
    
    round(cast(price as numeric), -3)
 as rounded_price,
    city as address,
    
    case
        when lower(city) like '%дом%' then 'house'
        when lower(city) like '%квартира%' then 'flat'
        else 'unknown'
end
 as property_type,
    
    case
        when date ~ '^\d{4}-\d{2}-\d{2}$' then to_date(date, 'YYYY-MM-DD')
        else null
end
 as standardized_date,
    
    case
        when extract(dow from to_date(date, 'YYYY-MM-DD')) in (0, 6) then true
        else false
end
 as is_weekend,
    sqm as area,
    rooms,
    name, -- название квартиры
    year_of_est -- год постройки
from raw
  );
  
[0m17:38:16.278737 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  неверное значение "а" для "MM"
DETAIL:  Значение должно быть целым числом.

[0m17:38:16.279164 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: ROLLBACK
[0m17:38:16.279754 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: Close
[0m17:38:16.285875 [debug] [Thread-1 (]: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  неверное значение "а" для "MM"
  DETAIL:  Значение должно быть целым числом.
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:38:16.286385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f00fac8-dc0e-4204-96db-c52723fac473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227221BB570>]}
[0m17:38:16.286944 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.transform_data .................... [[31mERROR[0m in 0.18s]
[0m17:38:16.287650 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.transform_data
[0m17:38:16.288206 [debug] [Thread-4 (]: Marking all children of 'model.krisha_data_pipeline.transform_data' to be skipped because of status 'error'.  Reason: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  неверное значение "а" для "MM"
  DETAIL:  Значение должно быть целым числом.
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql.
[0m17:38:16.289304 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.final_model
[0m17:38:16.289666 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.final_model ........................................ [[33mSKIP[0m]
[0m17:38:16.290182 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.final_model
[0m17:38:16.291266 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:16.291566 [debug] [MainThread]: On master: BEGIN
[0m17:38:16.291824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:16.339014 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m17:38:16.339540 [debug] [MainThread]: On master: COMMIT
[0m17:38:16.339990 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:16.340295 [debug] [MainThread]: On master: COMMIT
[0m17:38:16.340771 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:38:16.341089 [debug] [MainThread]: On master: Close
[0m17:38:16.341579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:16.341850 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m17:38:16.342214 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m17:38:16.342591 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.transform_data' was properly closed.
[0m17:38:16.343136 [info ] [MainThread]: 
[0m17:38:16.343834 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m17:38:16.345211 [debug] [MainThread]: Command end result
[0m17:38:16.370395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:38:16.372603 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:38:16.378461 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\run_results.json
[0m17:38:16.378797 [info ] [MainThread]: 
[0m17:38:16.379289 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:38:16.379756 [info ] [MainThread]: 
[0m17:38:16.380252 [error] [MainThread]:   Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  неверное значение "а" для "MM"
  DETAIL:  Значение должно быть целым числом.
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:38:16.380739 [info ] [MainThread]: 
[0m17:38:16.381320 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m17:38:16.382209 [debug] [MainThread]: Command `dbt run` failed at 17:38:16.382061 after 2.48 seconds
[0m17:38:16.382648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002271EEFD1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002271F3FACD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227204EF9A0>]}
[0m17:38:16.382983 [debug] [MainThread]: Flushing usage events
[0m17:38:17.126082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:48:14.471424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018207AA63C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001820576A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018208A13ED0>]}


============================== 17:48:14.476116 | 7dd66d27-7e0a-4e13-80f4-131448e2b051 ==============================
[0m17:48:14.476116 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:48:14.476682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:48:14.661635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dd66d27-7e0a-4e13-80f4-131448e2b051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018208BC2D70>]}
[0m17:48:14.718834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dd66d27-7e0a-4e13-80f4-131448e2b051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018208903020>]}
[0m17:48:14.719746 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:48:14.946525 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:48:15.082739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:48:15.083350 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\transform_data.sql
[0m17:48:15.457622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dd66d27-7e0a-4e13-80f4-131448e2b051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018209E53D50>]}
[0m17:48:15.527102 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:48:15.530028 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:48:15.546284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dd66d27-7e0a-4e13-80f4-131448e2b051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018207B49130>]}
[0m17:48:15.546703 [info ] [MainThread]: Found 3 models, 3 data tests, 1 source, 438 macros
[0m17:48:15.547172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dd66d27-7e0a-4e13-80f4-131448e2b051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001820A21F850>]}
[0m17:48:15.548757 [info ] [MainThread]: 
[0m17:48:15.549217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:48:15.549644 [info ] [MainThread]: 
[0m17:48:15.550214 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:48:15.564320 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m17:48:15.629449 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m17:48:15.629798 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m17:48:15.630057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:15.689730 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.060 seconds
[0m17:48:15.690962 [debug] [ThreadPool]: On list_krisha_data: Close
[0m17:48:15.692527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m17:48:15.697352 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:48:15.697704 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m17:48:15.697961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:15.740284 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m17:48:15.740639 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:48:15.740918 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:48:15.756346 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.015 seconds
[0m17:48:15.757591 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m17:48:15.758025 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m17:48:15.762617 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:15.762957 [debug] [MainThread]: On master: BEGIN
[0m17:48:15.763211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:15.805445 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m17:48:15.805801 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:15.806122 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:48:15.821181 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m17:48:15.822324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dd66d27-7e0a-4e13-80f4-131448e2b051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001820A2547A0>]}
[0m17:48:15.822716 [debug] [MainThread]: On master: ROLLBACK
[0m17:48:15.823187 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:15.823452 [debug] [MainThread]: On master: BEGIN
[0m17:48:15.824012 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:48:15.824277 [debug] [MainThread]: On master: COMMIT
[0m17:48:15.824535 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:15.824783 [debug] [MainThread]: On master: COMMIT
[0m17:48:15.825161 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:48:15.825426 [debug] [MainThread]: On master: Close
[0m17:48:15.828631 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.raw_data
[0m17:48:15.829148 [info ] [Thread-1 (]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m17:48:15.829780 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m17:48:15.830118 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.raw_data
[0m17:48:15.839725 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m17:48:15.840716 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.raw_data
[0m17:48:15.933780 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m17:48:15.934849 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:48:15.935249 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m17:48:15.935607 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:48:15.981791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m17:48:15.982185 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:48:15.982500 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m17:48:15.994656 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.012 seconds
[0m17:48:16.002712 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:48:16.003094 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data" rename to "raw_data__dbt_backup"
[0m17:48:16.005356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:48:16.007975 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:48:16.008311 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m17:48:16.009081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:48:16.022918 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:48:16.023320 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:48:16.023634 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:48:16.025535 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:48:16.030723 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m17:48:16.034880 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:48:16.035224 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m17:48:16.043677 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m17:48:16.045873 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: Close
[0m17:48:16.047562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd66d27-7e0a-4e13-80f4-131448e2b051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018209EFFAD0>]}
[0m17:48:16.048247 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.22s]
[0m17:48:16.049102 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.raw_data
[0m17:48:16.049521 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.transform_data
[0m17:48:16.050030 [info ] [Thread-1 (]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m17:48:16.050593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m17:48:16.050988 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.transform_data
[0m17:48:16.053900 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m17:48:16.054728 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.transform_data
[0m17:48:16.058198 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m17:48:16.059106 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:48:16.059438 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m17:48:16.059735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:16.247033 [debug] [Thread-1 (]: SQL status: BEGIN in 0.187 seconds
[0m17:48:16.247430 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:48:16.247780 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

with raw as (
    select *
    from "krisha_data"."public"."raw_flats"
    where price > 0
)

select
    row_number() over () as id,
    
    round(cast(price as numeric), -3)
 as rounded_price,
    city as address,  -- Заменил 'address' на 'city'
    
    case
        when lower(city) like '%дом%' then 'house'
        when lower(city) like '%квартира%' then 'flat'
        else 'unknown'
end
 as property_type,  -- Здесь исправил: передаю 'city', а не 'address'
    date as standardized_date,  -- Просто оставляем как есть, без обработки
    null as is_weekend,  -- Пока ставим null вместо проверки выходного дня
    sqm as area,  -- Заменил 'area' на 'sqm'
    rooms,
    floor,
    total_floors,
    description
from raw
  );
  
[0m17:48:16.250973 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец "floor" не существует
LINE 37:     floor,
             ^

[0m17:48:16.251326 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: ROLLBACK
[0m17:48:16.251845 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: Close
[0m17:48:16.257721 [debug] [Thread-1 (]: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "floor" не существует
  LINE 37:     floor,
               ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:48:16.258227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd66d27-7e0a-4e13-80f4-131448e2b051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001820A6B4730>]}
[0m17:48:16.258824 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.transform_data .................... [[31mERROR[0m in 0.21s]
[0m17:48:16.259559 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.transform_data
[0m17:48:16.260093 [debug] [Thread-4 (]: Marking all children of 'model.krisha_data_pipeline.transform_data' to be skipped because of status 'error'.  Reason: Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "floor" не существует
  LINE 37:     floor,
               ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql.
[0m17:48:16.261207 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.final_model
[0m17:48:16.261573 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.final_model ........................................ [[33mSKIP[0m]
[0m17:48:16.262082 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.final_model
[0m17:48:16.263234 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:16.263539 [debug] [MainThread]: On master: BEGIN
[0m17:48:16.263798 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:48:16.309482 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m17:48:16.309878 [debug] [MainThread]: On master: COMMIT
[0m17:48:16.310157 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:16.310415 [debug] [MainThread]: On master: COMMIT
[0m17:48:16.310774 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:48:16.311054 [debug] [MainThread]: On master: Close
[0m17:48:16.311473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:16.311743 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m17:48:16.312010 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m17:48:16.312244 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.transform_data' was properly closed.
[0m17:48:16.312572 [info ] [MainThread]: 
[0m17:48:16.313005 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m17:48:16.314082 [debug] [MainThread]: Command end result
[0m17:48:16.331649 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:48:16.333502 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:48:16.339452 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\run_results.json
[0m17:48:16.339779 [info ] [MainThread]: 
[0m17:48:16.340249 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:48:16.340690 [info ] [MainThread]: 
[0m17:48:16.341176 [error] [MainThread]:   Database Error in model transform_data (models\transform_data.sql)
  ОШИБКА:  столбец "floor" не существует
  LINE 37:     floor,
               ^
  compiled code at target\run\krisha_data_pipeline\models\transform_data.sql
[0m17:48:16.341614 [info ] [MainThread]: 
[0m17:48:16.342035 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m17:48:16.342777 [debug] [MainThread]: Command `dbt run` failed at 17:48:16.342666 after 2.03 seconds
[0m17:48:16.343111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001820A121090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001820A6A0E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001820733D1D0>]}
[0m17:48:16.343432 [debug] [MainThread]: Flushing usage events
[0m17:48:17.253660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:52:19.852861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFB8BE3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EF954E5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFC81FED0>]}


============================== 17:52:19.856495 | 63f21ca0-0862-422d-9311-9e8ded5bb670 ==============================
[0m17:52:19.856495 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:52:19.857101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:52:20.003851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63f21ca0-0862-422d-9311-9e8ded5bb670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFC9D2D70>]}
[0m17:52:20.059444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63f21ca0-0862-422d-9311-9e8ded5bb670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFC713020>]}
[0m17:52:20.060303 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:52:20.276444 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:52:20.397790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:52:20.398357 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\transform_data.sql
[0m17:52:20.772481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63f21ca0-0862-422d-9311-9e8ded5bb670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFDC13D50>]}
[0m17:52:20.841914 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:52:20.844809 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:52:20.861029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63f21ca0-0862-422d-9311-9e8ded5bb670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFB959130>]}
[0m17:52:20.861442 [info ] [MainThread]: Found 3 models, 3 data tests, 1 source, 438 macros
[0m17:52:20.861968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63f21ca0-0862-422d-9311-9e8ded5bb670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFDFDF850>]}
[0m17:52:20.863529 [info ] [MainThread]: 
[0m17:52:20.863980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:52:20.864376 [info ] [MainThread]: 
[0m17:52:20.864917 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:52:20.869428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m17:52:20.931398 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m17:52:20.931767 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m17:52:20.932041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:20.982500 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.050 seconds
[0m17:52:20.983642 [debug] [ThreadPool]: On list_krisha_data: Close
[0m17:52:20.985339 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m17:52:20.990344 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:52:20.990687 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m17:52:20.990937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:21.034955 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m17:52:21.035390 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m17:52:21.035702 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:52:21.042129 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m17:52:21.043358 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m17:52:21.043811 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m17:52:21.048261 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:21.048593 [debug] [MainThread]: On master: BEGIN
[0m17:52:21.048847 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:21.091052 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m17:52:21.091447 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:21.091772 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:52:21.099750 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m17:52:21.100855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63f21ca0-0862-422d-9311-9e8ded5bb670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFE0187A0>]}
[0m17:52:21.101296 [debug] [MainThread]: On master: ROLLBACK
[0m17:52:21.101755 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:21.102021 [debug] [MainThread]: On master: BEGIN
[0m17:52:21.102591 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:52:21.102860 [debug] [MainThread]: On master: COMMIT
[0m17:52:21.103120 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:21.103370 [debug] [MainThread]: On master: COMMIT
[0m17:52:21.103752 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:52:21.104022 [debug] [MainThread]: On master: Close
[0m17:52:21.107831 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.raw_data
[0m17:52:21.108332 [info ] [Thread-1 (]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m17:52:21.108932 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m17:52:21.109263 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.raw_data
[0m17:52:21.118809 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m17:52:21.119666 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.raw_data
[0m17:52:21.207047 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m17:52:21.208084 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:52:21.208514 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m17:52:21.208866 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:52:21.256171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m17:52:21.256571 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:52:21.256965 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m17:52:21.278424 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.021 seconds
[0m17:52:21.286719 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:52:21.287097 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data" rename to "raw_data__dbt_backup"
[0m17:52:21.287842 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:52:21.290364 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:52:21.290692 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m17:52:21.292202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:52:21.306144 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:52:21.306548 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:52:21.306862 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m17:52:21.308898 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:52:21.314051 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m17:52:21.318163 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m17:52:21.318504 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m17:52:21.323051 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m17:52:21.325300 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: Close
[0m17:52:21.327085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63f21ca0-0862-422d-9311-9e8ded5bb670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFDCBFAD0>]}
[0m17:52:21.327772 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.22s]
[0m17:52:21.328603 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.raw_data
[0m17:52:21.328998 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.transform_data
[0m17:52:21.329544 [info ] [Thread-1 (]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m17:52:21.330109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m17:52:21.330440 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.transform_data
[0m17:52:21.333477 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m17:52:21.334320 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.transform_data
[0m17:52:21.336822 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m17:52:21.337617 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:52:21.337941 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m17:52:21.338232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:21.381193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m17:52:21.381578 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:52:21.381995 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

with raw as (
    select *
    from "krisha_data"."public"."raw_flats"
    where price > 0
)

select
    row_number() over () as id,
    
    round(cast(price as numeric), -3)
 as rounded_price,
    city as address,  -- Заменил 'address' на 'city'
    
    case
        when lower(city) like '%дом%' then 'house'
        when lower(city) like '%квартира%' then 'flat'
        else 'unknown'
end
 as property_type,  -- Здесь исправил: передаю 'city', а не 'address'
    date as standardized_date,  -- Просто оставляем как есть, без обработки
    null as is_weekend,  -- Пока ставим null вместо проверки выходного дня
    sqm as area,  -- Заменил 'area' на 'sqm'
    rooms,
    null as floor,  -- Поскольку 'floor' не существует в данных, ставим null
    null as total_floors,  -- Поскольку 'total_floors' не существует в данных, ставим null
    null as description  -- Поскольку 'description' не существует в данных, ставим null
from raw
  );
  
[0m17:52:21.394097 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.012 seconds
[0m17:52:21.396952 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:52:21.397300 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public"."transform_data" rename to "transform_data__dbt_backup"
[0m17:52:21.398000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:52:21.400148 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:52:21.400470 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public"."transform_data__dbt_tmp" rename to "transform_data"
[0m17:52:21.401114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:52:21.402314 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m17:52:21.402667 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:52:21.402972 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m17:52:21.404797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:52:21.406626 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."transform_data__dbt_backup"
[0m17:52:21.407131 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m17:52:21.407440 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
drop table if exists "krisha_data"."public"."transform_data__dbt_backup" cascade
[0m17:52:21.413601 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m17:52:21.414922 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: Close
[0m17:52:21.415529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63f21ca0-0862-422d-9311-9e8ded5bb670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFE474050>]}
[0m17:52:21.416133 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.transform_data ........................ [[32mSELECT 103[0m in 0.09s]
[0m17:52:21.416993 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.transform_data
[0m17:52:21.417748 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.final_model
[0m17:52:21.418281 [info ] [Thread-1 (]: 3 of 3 START sql table model public.final_model ................................ [RUN]
[0m17:52:21.418918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.transform_data, now model.krisha_data_pipeline.final_model)
[0m17:52:21.419259 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.final_model
[0m17:52:21.421768 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.final_model"
[0m17:52:21.422618 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.final_model
[0m17:52:21.425057 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.final_model"
[0m17:52:21.425852 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:52:21.426172 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: BEGIN
[0m17:52:21.426465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:21.471497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m17:52:21.471882 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:52:21.472280 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */

  
    

  create  table "krisha_data"."public"."final_model__dbt_tmp"
  
  
    as
  
  (
    -- models/final_model.sql

select
    id,
    rounded_price,
    property_type,
    address,
    standardized_date,
    is_weekend,
    area,
    rooms,
    floor,
    total_floors,
    description
from "krisha_data"."public"."transform_data"
where rounded_price is not null
  );
  
[0m17:52:21.483458 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.011 seconds
[0m17:52:21.486036 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:52:21.486385 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
alter table "krisha_data"."public"."final_model" rename to "final_model__dbt_backup"
[0m17:52:21.487043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:52:21.489481 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:52:21.489800 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
alter table "krisha_data"."public"."final_model__dbt_tmp" rename to "final_model"
[0m17:52:21.490476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:52:21.491643 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: COMMIT
[0m17:52:21.492031 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:52:21.492369 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: COMMIT
[0m17:52:21.493955 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:52:21.495740 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."final_model__dbt_backup"
[0m17:52:21.496225 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m17:52:21.496531 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
drop table if exists "krisha_data"."public"."final_model__dbt_backup" cascade
[0m17:52:21.500647 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m17:52:21.501930 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: Close
[0m17:52:21.502487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63f21ca0-0862-422d-9311-9e8ded5bb670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFDE1EC10>]}
[0m17:52:21.503059 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.final_model ........................... [[32mSELECT 103[0m in 0.08s]
[0m17:52:21.503751 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.final_model
[0m17:52:21.504970 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:21.505301 [debug] [MainThread]: On master: BEGIN
[0m17:52:21.505555 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:52:21.659070 [debug] [MainThread]: SQL status: BEGIN in 0.153 seconds
[0m17:52:21.659534 [debug] [MainThread]: On master: COMMIT
[0m17:52:21.659806 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:21.660055 [debug] [MainThread]: On master: COMMIT
[0m17:52:21.660493 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:52:21.660774 [debug] [MainThread]: On master: Close
[0m17:52:21.661253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:21.661641 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m17:52:21.661937 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m17:52:21.662182 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.final_model' was properly closed.
[0m17:52:21.662509 [info ] [MainThread]: 
[0m17:52:21.663002 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m17:52:21.664264 [debug] [MainThread]: Command end result
[0m17:52:21.681710 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m17:52:21.683741 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m17:52:21.690184 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\run_results.json
[0m17:52:21.690505 [info ] [MainThread]: 
[0m17:52:21.691014 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:52:21.691448 [info ] [MainThread]: 
[0m17:52:21.691887 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:52:21.692591 [debug] [MainThread]: Command `dbt run` succeeded at 17:52:21.692485 after 1.99 seconds
[0m17:52:21.692909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFDF44050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFE0579D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EFC73B9A0>]}
[0m17:52:21.693218 [debug] [MainThread]: Flushing usage events
[0m17:52:22.611818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:01:58.833809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6659E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6422A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E67503ED0>]}


============================== 18:01:58.837482 | b347cbc4-5385-407e-8cfe-7da8ed871866 ==============================
[0m18:01:58.837482 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:01:58.838020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:01:58.983765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b347cbc4-5385-407e-8cfe-7da8ed871866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E67782D70>]}
[0m18:01:59.039422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b347cbc4-5385-407e-8cfe-7da8ed871866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E673F3020>]}
[0m18:01:59.040264 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:01:59.251121 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:01:59.373028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:01:59.373595 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\transform_data.sql
[0m18:01:59.748379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b347cbc4-5385-407e-8cfe-7da8ed871866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E68977D50>]}
[0m18:01:59.816974 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m18:01:59.819975 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m18:01:59.836634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b347cbc4-5385-407e-8cfe-7da8ed871866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E66639130>]}
[0m18:01:59.837061 [info ] [MainThread]: Found 3 models, 3 data tests, 1 source, 438 macros
[0m18:01:59.837503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b347cbc4-5385-407e-8cfe-7da8ed871866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E68D3B850>]}
[0m18:01:59.839045 [info ] [MainThread]: 
[0m18:01:59.839440 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:59.839793 [info ] [MainThread]: 
[0m18:01:59.840392 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:01:59.844010 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m18:01:59.906162 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m18:01:59.906560 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m18:01:59.906828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:59.955537 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m18:01:59.956844 [debug] [ThreadPool]: On list_krisha_data: Close
[0m18:01:59.958630 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m18:01:59.963388 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m18:01:59.963737 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m18:01:59.963994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:00.008422 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m18:02:00.008815 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m18:02:00.009120 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:02:00.015615 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m18:02:00.016890 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m18:02:00.017347 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m18:02:00.022188 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:00.022575 [debug] [MainThread]: On master: BEGIN
[0m18:02:00.022888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:00.064988 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m18:02:00.065340 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:00.065661 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:02:00.073567 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m18:02:00.074675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b347cbc4-5385-407e-8cfe-7da8ed871866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E68D7C7A0>]}
[0m18:02:00.075057 [debug] [MainThread]: On master: ROLLBACK
[0m18:02:00.075515 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:00.075791 [debug] [MainThread]: On master: BEGIN
[0m18:02:00.076372 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:02:00.076659 [debug] [MainThread]: On master: COMMIT
[0m18:02:00.076925 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:00.077173 [debug] [MainThread]: On master: COMMIT
[0m18:02:00.077568 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:02:00.077869 [debug] [MainThread]: On master: Close
[0m18:02:00.081322 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.raw_data
[0m18:02:00.082134 [info ] [Thread-1 (]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m18:02:00.082844 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m18:02:00.083211 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.raw_data
[0m18:02:00.093366 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m18:02:00.094386 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.raw_data
[0m18:02:00.186284 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m18:02:00.187471 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:02:00.187949 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m18:02:00.188333 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:02:00.331978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.144 seconds
[0m18:02:00.332375 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:02:00.332694 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m18:02:00.345976 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.013 seconds
[0m18:02:00.354043 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:02:00.354425 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data" rename to "raw_data__dbt_backup"
[0m18:02:00.355337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:02:00.357888 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:02:00.358235 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m18:02:00.358934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:02:00.372967 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m18:02:00.373368 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:02:00.373671 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m18:02:00.375440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:02:00.380641 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m18:02:00.384955 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:02:00.385339 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m18:02:00.389796 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:02:00.392082 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: Close
[0m18:02:00.393911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b347cbc4-5385-407e-8cfe-7da8ed871866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E68B17AD0>]}
[0m18:02:00.394580 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.31s]
[0m18:02:00.395460 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.raw_data
[0m18:02:00.395894 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.transform_data
[0m18:02:00.396445 [info ] [Thread-1 (]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m18:02:00.397054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m18:02:00.397403 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.transform_data
[0m18:02:00.400482 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m18:02:00.401480 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.transform_data
[0m18:02:00.404874 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m18:02:00.405810 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:02:00.406144 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m18:02:00.406438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:00.449600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m18:02:00.449985 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:02:00.450328 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

with raw as (
    select *
    from "krisha_data"."public"."raw_flats"
    where price > 0
)

select
    row_number() over () as id,
    
    round(cast(price as numeric), -3)
 as rounded_price,
    city as address,  -- Заменил 'address' на 'city'
    
    case
        when lower(city) like '%дом%' then 'house'
        when lower(city) like '%квартира%' then 'flat'
        else 'unknown'
end
 as property_type,  -- Здесь исправил: передаю 'city', а не 'address'
    date as standardized_date,  -- Просто оставляем как есть, без обработки
    null as is_weekend,  -- оставляем null, если нужно
    sqm as area,  -- Заменил 'area' на 'sqm'
    rooms
from raw
  );
  
[0m18:02:00.459276 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.008 seconds
[0m18:02:00.462340 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:02:00.462697 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public"."transform_data" rename to "transform_data__dbt_backup"
[0m18:02:00.463548 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:02:00.465804 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:02:00.466137 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public"."transform_data__dbt_tmp" rename to "transform_data"
[0m18:02:00.466828 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:02:00.468176 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m18:02:00.468573 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:02:00.468883 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m18:02:00.470608 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:02:00.472481 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."transform_data__dbt_backup"
[0m18:02:00.472982 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:02:00.473304 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
drop table if exists "krisha_data"."public"."transform_data__dbt_backup" cascade
[0m18:02:00.476603 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:02:00.477909 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: Close
[0m18:02:00.478487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b347cbc4-5385-407e-8cfe-7da8ed871866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E691D4050>]}
[0m18:02:00.479114 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.transform_data ........................ [[32mSELECT 103[0m in 0.08s]
[0m18:02:00.479891 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.transform_data
[0m18:02:00.480618 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.final_model
[0m18:02:00.481197 [info ] [Thread-1 (]: 3 of 3 START sql table model public.final_model ................................ [RUN]
[0m18:02:00.481773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.transform_data, now model.krisha_data_pipeline.final_model)
[0m18:02:00.482118 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.final_model
[0m18:02:00.485045 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.final_model"
[0m18:02:00.486433 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.final_model
[0m18:02:00.488926 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.final_model"
[0m18:02:00.489718 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:02:00.490042 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: BEGIN
[0m18:02:00.490356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:00.534791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m18:02:00.535182 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:02:00.535501 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */

  
    

  create  table "krisha_data"."public"."final_model__dbt_tmp"
  
  
    as
  
  (
    -- models/final_model.sql

select
    id,
    rounded_price,
    property_type,
    address,
    standardized_date,
    is_weekend,
    area,
    rooms,
    floor,
    total_floors,
    description
from "krisha_data"."public"."transform_data"
where rounded_price is not null
  );
  
[0m18:02:00.537507 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец "floor" не существует
LINE 23:     floor,
             ^

[0m18:02:00.537850 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: ROLLBACK
[0m18:02:00.538379 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: Close
[0m18:02:00.549076 [debug] [Thread-1 (]: Database Error in model final_model (models\final_model.sql)
  ОШИБКА:  столбец "floor" не существует
  LINE 23:     floor,
               ^
  compiled code at target\run\krisha_data_pipeline\models\final_model.sql
[0m18:02:00.549562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b347cbc4-5385-407e-8cfe-7da8ed871866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E68B6D9F0>]}
[0m18:02:00.550104 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public.final_model ....................... [[31mERROR[0m in 0.07s]
[0m18:02:00.550751 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.final_model
[0m18:02:00.551286 [debug] [Thread-4 (]: Marking all children of 'model.krisha_data_pipeline.final_model' to be skipped because of status 'error'.  Reason: Database Error in model final_model (models\final_model.sql)
  ОШИБКА:  столбец "floor" не существует
  LINE 23:     floor,
               ^
  compiled code at target\run\krisha_data_pipeline\models\final_model.sql.
[0m18:02:00.552787 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:00.553078 [debug] [MainThread]: On master: BEGIN
[0m18:02:00.553334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:02:00.596307 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m18:02:00.596709 [debug] [MainThread]: On master: COMMIT
[0m18:02:00.596990 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:00.597249 [debug] [MainThread]: On master: COMMIT
[0m18:02:00.597698 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:02:00.597984 [debug] [MainThread]: On master: Close
[0m18:02:00.598412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:00.598669 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m18:02:00.598937 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m18:02:00.599174 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.final_model' was properly closed.
[0m18:02:00.599513 [info ] [MainThread]: 
[0m18:02:00.600081 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m18:02:00.601401 [debug] [MainThread]: Command end result
[0m18:02:00.618846 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m18:02:00.620964 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m18:02:00.626256 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\run_results.json
[0m18:02:00.626581 [info ] [MainThread]: 
[0m18:02:00.627080 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:02:00.627530 [info ] [MainThread]: 
[0m18:02:00.628051 [error] [MainThread]:   Database Error in model final_model (models\final_model.sql)
  ОШИБКА:  столбец "floor" не существует
  LINE 23:     floor,
               ^
  compiled code at target\run\krisha_data_pipeline\models\final_model.sql
[0m18:02:00.628544 [info ] [MainThread]: 
[0m18:02:00.629007 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:02:00.629805 [debug] [MainThread]: Command `dbt run` failed at 18:02:00.629691 after 1.96 seconds
[0m18:02:00.630148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E69160350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E68CA4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6741B9A0>]}
[0m18:02:00.630470 [debug] [MainThread]: Flushing usage events
[0m18:02:01.614372 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:02:52.354247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124CC0E63C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124C9DA25D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124CD053ED0>]}


============================== 18:02:52.357880 | 89739f0e-5e32-4223-9f37-e71e409770ca ==============================
[0m18:02:52.357880 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:02:52.358453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:02:52.504268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89739f0e-5e32-4223-9f37-e71e409770ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124CD2D2D70>]}
[0m18:02:52.560226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89739f0e-5e32-4223-9f37-e71e409770ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124CCF43020>]}
[0m18:02:52.561082 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:02:52.778085 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:02:52.905393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:02:52.905977 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\transform_data.sql
[0m18:02:52.906359 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\final_model.sql
[0m18:02:53.303068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89739f0e-5e32-4223-9f37-e71e409770ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124CE4C7D50>]}
[0m18:02:53.377412 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m18:02:53.380447 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m18:02:53.396656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89739f0e-5e32-4223-9f37-e71e409770ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124CD0937A0>]}
[0m18:02:53.397088 [info ] [MainThread]: Found 3 models, 3 data tests, 1 source, 438 macros
[0m18:02:53.397523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89739f0e-5e32-4223-9f37-e71e409770ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124CE88BE70>]}
[0m18:02:53.399056 [info ] [MainThread]: 
[0m18:02:53.399458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:02:53.399786 [info ] [MainThread]: 
[0m18:02:53.400242 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:02:53.403617 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m18:02:53.463712 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m18:02:53.464064 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m18:02:53.464329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:53.515483 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m18:02:53.516648 [debug] [ThreadPool]: On list_krisha_data: Close
[0m18:02:53.518559 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m18:02:53.523250 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m18:02:53.523580 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m18:02:53.523838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:53.566624 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m18:02:53.567011 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m18:02:53.567299 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:02:53.572698 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m18:02:53.573948 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m18:02:53.574363 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m18:02:53.578643 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:53.578978 [debug] [MainThread]: On master: BEGIN
[0m18:02:53.579232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:53.621546 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m18:02:53.621904 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:53.622230 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:02:53.629320 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:02:53.630415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89739f0e-5e32-4223-9f37-e71e409770ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124CE8C4870>]}
[0m18:02:53.630803 [debug] [MainThread]: On master: ROLLBACK
[0m18:02:53.631230 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:53.631499 [debug] [MainThread]: On master: BEGIN
[0m18:02:53.631960 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:02:53.632231 [debug] [MainThread]: On master: COMMIT
[0m18:02:53.632495 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:53.632748 [debug] [MainThread]: On master: COMMIT
[0m18:02:53.633090 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:02:53.633364 [debug] [MainThread]: On master: Close
[0m18:02:53.636857 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.raw_data
[0m18:02:53.637378 [info ] [Thread-1 (]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m18:02:53.637921 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m18:02:53.638248 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.raw_data
[0m18:02:53.647303 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m18:02:53.648152 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.raw_data
[0m18:02:53.741146 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m18:02:53.742257 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:02:53.742660 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m18:02:53.743017 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:02:53.788625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m18:02:53.789027 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:02:53.789351 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m18:02:53.798042 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.008 seconds
[0m18:02:53.806347 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:02:53.806718 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data" rename to "raw_data__dbt_backup"
[0m18:02:53.807415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:02:53.810133 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:02:53.810500 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m18:02:53.811240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:02:53.825287 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m18:02:53.825758 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:02:53.826074 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m18:02:53.828013 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:02:53.833473 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m18:02:53.837767 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:02:53.838121 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m18:02:53.841359 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:02:53.843636 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: Close
[0m18:02:53.845391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89739f0e-5e32-4223-9f37-e71e409770ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124CE57BAD0>]}
[0m18:02:53.846123 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.21s]
[0m18:02:53.846876 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.raw_data
[0m18:02:53.847299 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.transform_data
[0m18:02:53.847847 [info ] [Thread-1 (]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m18:02:53.848426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m18:02:53.848761 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.transform_data
[0m18:02:53.851748 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m18:02:53.852640 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.transform_data
[0m18:02:53.855056 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m18:02:53.855876 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:02:53.856229 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m18:02:53.856532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:53.899922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m18:02:53.900314 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:02:53.900664 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

with raw as (
    select *
    from "krisha_data"."public"."raw_flats"
    where price > 0
)

select
    row_number() over () as id,
    
    round(cast(price as numeric), -3)
 as rounded_price,
    city as address,  -- Заменил 'address' на 'city'
    
    case
        when lower(city) like '%дом%' then 'house'
        when lower(city) like '%квартира%' then 'flat'
        else 'unknown'
end
 as property_type,  -- Здесь исправил: передаю 'city', а не 'address'
    date as standardized_date,  -- Просто оставляем как есть, без обработки
    sqm as area,  -- Заменил 'area' на 'sqm'
    rooms
from raw
  );
  
[0m18:02:53.910372 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.009 seconds
[0m18:02:53.913354 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:02:53.913747 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public"."transform_data" rename to "transform_data__dbt_backup"
[0m18:02:53.914427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:02:53.916600 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:02:53.916921 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public"."transform_data__dbt_tmp" rename to "transform_data"
[0m18:02:53.917588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:02:53.918784 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m18:02:53.919120 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:02:53.919439 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m18:02:53.921163 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:02:53.922998 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."transform_data__dbt_backup"
[0m18:02:53.923499 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:02:53.923812 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
drop table if exists "krisha_data"."public"."transform_data__dbt_backup" cascade
[0m18:02:53.927873 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:02:53.929230 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: Close
[0m18:02:53.929859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89739f0e-5e32-4223-9f37-e71e409770ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124CED243C0>]}
[0m18:02:53.930492 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.transform_data ........................ [[32mSELECT 103[0m in 0.08s]
[0m18:02:53.931137 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.transform_data
[0m18:02:53.931783 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.final_model
[0m18:02:53.932453 [info ] [Thread-1 (]: 3 of 3 START sql table model public.final_model ................................ [RUN]
[0m18:02:53.933002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.transform_data, now model.krisha_data_pipeline.final_model)
[0m18:02:53.933463 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.final_model
[0m18:02:53.936503 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.final_model"
[0m18:02:53.937412 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.final_model
[0m18:02:53.939829 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.final_model"
[0m18:02:53.940808 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:02:53.941157 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: BEGIN
[0m18:02:53.941457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:53.986367 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m18:02:53.986751 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:02:53.987069 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */

  
    

  create  table "krisha_data"."public"."final_model__dbt_tmp"
  
  
    as
  
  (
    -- models/final_model.sql

select
    id,
    rounded_price,
    property_type,
    address,
    standardized_date,
    area,
    rooms,
from "krisha_data"."public"."transform_data"
where rounded_price is not null
  );
  
[0m18:02:53.987751 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  ошибка синтаксиса (примерное положение: "from")
LINE 22: from "krisha_data"."public"."transform_data"
         ^

[0m18:02:53.988093 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: ROLLBACK
[0m18:02:53.988678 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: Close
[0m18:02:53.994668 [debug] [Thread-1 (]: Database Error in model final_model (models\final_model.sql)
  ОШИБКА:  ошибка синтаксиса (примерное положение: "from")
  LINE 22: from "krisha_data"."public"."transform_data"
           ^
  compiled code at target\run\krisha_data_pipeline\models\final_model.sql
[0m18:02:53.995144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89739f0e-5e32-4223-9f37-e71e409770ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124CE6BC370>]}
[0m18:02:53.995691 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public.final_model ....................... [[31mERROR[0m in 0.06s]
[0m18:02:53.996421 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.final_model
[0m18:02:53.996951 [debug] [Thread-4 (]: Marking all children of 'model.krisha_data_pipeline.final_model' to be skipped because of status 'error'.  Reason: Database Error in model final_model (models\final_model.sql)
  ОШИБКА:  ошибка синтаксиса (примерное положение: "from")
  LINE 22: from "krisha_data"."public"."transform_data"
           ^
  compiled code at target\run\krisha_data_pipeline\models\final_model.sql.
[0m18:02:53.998592 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:53.998938 [debug] [MainThread]: On master: BEGIN
[0m18:02:53.999198 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:02:54.044010 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m18:02:54.044381 [debug] [MainThread]: On master: COMMIT
[0m18:02:54.044670 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:54.044928 [debug] [MainThread]: On master: COMMIT
[0m18:02:54.045379 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:02:54.045666 [debug] [MainThread]: On master: Close
[0m18:02:54.046092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:54.046357 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m18:02:54.046628 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m18:02:54.046866 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.final_model' was properly closed.
[0m18:02:54.047196 [info ] [MainThread]: 
[0m18:02:54.047676 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m18:02:54.048775 [debug] [MainThread]: Command end result
[0m18:02:54.066407 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m18:02:54.068278 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m18:02:54.073434 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\run_results.json
[0m18:02:54.073749 [info ] [MainThread]: 
[0m18:02:54.074259 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:02:54.074710 [info ] [MainThread]: 
[0m18:02:54.075247 [error] [MainThread]:   Database Error in model final_model (models\final_model.sql)
  ОШИБКА:  ошибка синтаксиса (примерное положение: "from")
  LINE 22: from "krisha_data"."public"."transform_data"
           ^
  compiled code at target\run\krisha_data_pipeline\models\final_model.sql
[0m18:02:54.075703 [info ] [MainThread]: 
[0m18:02:54.076159 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:02:54.076919 [debug] [MainThread]: Command `dbt run` failed at 18:02:54.076811 after 1.83 seconds
[0m18:02:54.077252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124CBE82CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124CB9811D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124CCF6B9A0>]}
[0m18:02:54.077572 [debug] [MainThread]: Flushing usage events
[0m18:02:54.827972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:17.331111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4BD27E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4BAF0A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4BE1E3ED0>]}


============================== 18:04:17.334734 | 5222f1c8-046c-4067-8e73-a8d8ec123c06 ==============================
[0m18:04:17.334734 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:04:17.335290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:04:17.483121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5222f1c8-046c-4067-8e73-a8d8ec123c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4BE452D70>]}
[0m18:04:17.539130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5222f1c8-046c-4067-8e73-a8d8ec123c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4BE0D3020>]}
[0m18:04:17.539990 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:04:17.757176 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:04:17.879782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:04:17.880326 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\final_model.sql
[0m18:04:18.170584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5222f1c8-046c-4067-8e73-a8d8ec123c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4BF647B50>]}
[0m18:04:18.239581 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m18:04:18.242523 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m18:04:18.260840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5222f1c8-046c-4067-8e73-a8d8ec123c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4BE21F3E0>]}
[0m18:04:18.261254 [info ] [MainThread]: Found 3 models, 3 data tests, 1 source, 438 macros
[0m18:04:18.261728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5222f1c8-046c-4067-8e73-a8d8ec123c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4BFA20D70>]}
[0m18:04:18.263327 [info ] [MainThread]: 
[0m18:04:18.263838 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:18.264423 [info ] [MainThread]: 
[0m18:04:18.265057 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:04:18.268522 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m18:04:18.330346 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m18:04:18.330698 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m18:04:18.330960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:18.513984 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.183 seconds
[0m18:04:18.515184 [debug] [ThreadPool]: On list_krisha_data: Close
[0m18:04:18.516792 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m18:04:18.521692 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m18:04:18.522052 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m18:04:18.522300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:18.566804 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m18:04:18.567284 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m18:04:18.567646 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:04:18.575544 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m18:04:18.577154 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m18:04:18.577731 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m18:04:18.582320 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:18.582649 [debug] [MainThread]: On master: BEGIN
[0m18:04:18.582905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:18.624733 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m18:04:18.625097 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:18.625416 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:04:18.633388 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m18:04:18.634476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5222f1c8-046c-4067-8e73-a8d8ec123c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4BF897AD0>]}
[0m18:04:18.634854 [debug] [MainThread]: On master: ROLLBACK
[0m18:04:18.635292 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:18.635561 [debug] [MainThread]: On master: BEGIN
[0m18:04:18.636089 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:04:18.636360 [debug] [MainThread]: On master: COMMIT
[0m18:04:18.636617 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:18.636888 [debug] [MainThread]: On master: COMMIT
[0m18:04:18.637278 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:04:18.637555 [debug] [MainThread]: On master: Close
[0m18:04:18.641187 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.raw_data
[0m18:04:18.641683 [info ] [Thread-1 (]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m18:04:18.642251 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m18:04:18.642572 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.raw_data
[0m18:04:18.648946 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m18:04:18.649860 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.raw_data
[0m18:04:18.683115 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m18:04:18.684044 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:04:18.684376 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m18:04:18.684693 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:04:18.726151 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m18:04:18.726541 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:04:18.726867 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m18:04:18.737344 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.010 seconds
[0m18:04:18.745434 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:04:18.745818 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data" rename to "raw_data__dbt_backup"
[0m18:04:18.746763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:04:18.749117 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:04:18.749508 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m18:04:18.750214 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:04:18.766599 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m18:04:18.766996 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:04:18.767292 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m18:04:18.769688 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:04:18.774916 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m18:04:18.779113 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:04:18.779469 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m18:04:18.784163 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:04:18.786401 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: Close
[0m18:04:18.788119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5222f1c8-046c-4067-8e73-a8d8ec123c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4BFE0C7D0>]}
[0m18:04:18.788760 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.14s]
[0m18:04:18.789651 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.raw_data
[0m18:04:18.790064 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.transform_data
[0m18:04:18.790632 [info ] [Thread-1 (]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m18:04:18.791355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m18:04:18.791731 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.transform_data
[0m18:04:18.853212 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m18:04:18.854487 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.transform_data
[0m18:04:18.857846 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m18:04:18.858949 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:04:18.859399 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m18:04:18.859825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:18.909277 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m18:04:18.909674 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:04:18.910017 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

with raw as (
    select *
    from "krisha_data"."public"."raw_flats"
    where price > 0
)

select
    row_number() over () as id,
    
    round(cast(price as numeric), -3)
 as rounded_price,
    city as address,  -- Заменил 'address' на 'city'
    
    case
        when lower(city) like '%дом%' then 'house'
        when lower(city) like '%квартира%' then 'flat'
        else 'unknown'
end
 as property_type,  -- Здесь исправил: передаю 'city', а не 'address'
    date as standardized_date,  -- Просто оставляем как есть, без обработки
    sqm as area,  -- Заменил 'area' на 'sqm'
    rooms
from raw
  );
  
[0m18:04:18.918811 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.008 seconds
[0m18:04:18.921549 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:04:18.921891 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public"."transform_data" rename to "transform_data__dbt_backup"
[0m18:04:18.922687 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:04:18.924868 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:04:18.925191 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public"."transform_data__dbt_tmp" rename to "transform_data"
[0m18:04:18.925903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:04:18.927087 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m18:04:18.927427 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:04:18.927740 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m18:04:18.929638 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:04:18.931478 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."transform_data__dbt_backup"
[0m18:04:18.931984 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:04:18.932298 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
drop table if exists "krisha_data"."public"."transform_data__dbt_backup" cascade
[0m18:04:18.936244 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:04:18.937564 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: Close
[0m18:04:18.938150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5222f1c8-046c-4067-8e73-a8d8ec123c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4BF9B3750>]}
[0m18:04:18.938799 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.transform_data ........................ [[32mSELECT 103[0m in 0.15s]
[0m18:04:18.939688 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.transform_data
[0m18:04:18.940446 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.final_model
[0m18:04:18.940939 [info ] [Thread-1 (]: 3 of 3 START sql table model public.final_model ................................ [RUN]
[0m18:04:18.941822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.transform_data, now model.krisha_data_pipeline.final_model)
[0m18:04:18.942203 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.final_model
[0m18:04:18.944698 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.final_model"
[0m18:04:18.945573 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.final_model
[0m18:04:18.947924 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.final_model"
[0m18:04:18.948628 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:04:18.948939 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: BEGIN
[0m18:04:18.949236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:18.993837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m18:04:18.994249 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:04:18.994570 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */

  
    

  create  table "krisha_data"."public"."final_model__dbt_tmp"
  
  
    as
  
  (
    -- models/final_model.sql

select
    id,
    rounded_price,
    property_type,
    address,
    standardized_date,
    is_weekend,
    area,
    rooms
from "krisha_data"."public"."transform_data"
where rounded_price is not null
  and property_type is not null
  and address is not null
  and standardized_date is not null
  and area is not null
  and rooms is not null
  );
  
[0m18:04:18.995375 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ОШИБКА:  столбец "is_weekend" не существует
LINE 20:     is_weekend,
             ^

[0m18:04:18.995703 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: ROLLBACK
[0m18:04:18.996267 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: Close
[0m18:04:19.002267 [debug] [Thread-1 (]: Database Error in model final_model (models\final_model.sql)
  ОШИБКА:  столбец "is_weekend" не существует
  LINE 20:     is_weekend,
               ^
  compiled code at target\run\krisha_data_pipeline\models\final_model.sql
[0m18:04:19.002745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5222f1c8-046c-4067-8e73-a8d8ec123c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4BF88E490>]}
[0m18:04:19.003301 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public.final_model ....................... [[31mERROR[0m in 0.06s]
[0m18:04:19.003989 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.final_model
[0m18:04:19.004502 [debug] [Thread-4 (]: Marking all children of 'model.krisha_data_pipeline.final_model' to be skipped because of status 'error'.  Reason: Database Error in model final_model (models\final_model.sql)
  ОШИБКА:  столбец "is_weekend" не существует
  LINE 20:     is_weekend,
               ^
  compiled code at target\run\krisha_data_pipeline\models\final_model.sql.
[0m18:04:19.005985 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:19.006294 [debug] [MainThread]: On master: BEGIN
[0m18:04:19.006558 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:19.049339 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m18:04:19.049711 [debug] [MainThread]: On master: COMMIT
[0m18:04:19.049982 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:19.050236 [debug] [MainThread]: On master: COMMIT
[0m18:04:19.050653 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:04:19.050924 [debug] [MainThread]: On master: Close
[0m18:04:19.051333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:19.051585 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m18:04:19.051903 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m18:04:19.052142 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.final_model' was properly closed.
[0m18:04:19.052466 [info ] [MainThread]: 
[0m18:04:19.052918 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m18:04:19.054017 [debug] [MainThread]: Command end result
[0m18:04:19.072105 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m18:04:19.073955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m18:04:19.079459 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\run_results.json
[0m18:04:19.079800 [info ] [MainThread]: 
[0m18:04:19.080337 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:04:19.080844 [info ] [MainThread]: 
[0m18:04:19.081348 [error] [MainThread]:   Database Error in model final_model (models\final_model.sql)
  ОШИБКА:  столбец "is_weekend" не существует
  LINE 20:     is_weekend,
               ^
  compiled code at target\run\krisha_data_pipeline\models\final_model.sql
[0m18:04:19.081820 [info ] [MainThread]: 
[0m18:04:19.082245 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:04:19.083092 [debug] [MainThread]: Command `dbt run` failed at 18:04:19.082945 after 1.90 seconds
[0m18:04:19.083486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4BF809750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4BF97AA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4B76FA3C0>]}
[0m18:04:19.083840 [debug] [MainThread]: Flushing usage events
[0m18:04:20.048237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:47.275411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E727B0E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E72579A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E728A73ED0>]}


============================== 18:04:47.278963 | d40da9e3-9213-4704-93f0-49649d2cd008 ==============================
[0m18:04:47.278963 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:04:47.279542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:04:47.427103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd40da9e3-9213-4704-93f0-49649d2cd008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E728CD2D70>]}
[0m18:04:47.482672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd40da9e3-9213-4704-93f0-49649d2cd008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E728963020>]}
[0m18:04:47.483529 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:04:47.694177 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:04:47.816430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:04:47.818685 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\final_model.sql
[0m18:04:48.114086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd40da9e3-9213-4704-93f0-49649d2cd008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E729EC7A50>]}
[0m18:04:48.183728 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m18:04:48.186641 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m18:04:48.202462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd40da9e3-9213-4704-93f0-49649d2cd008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E728AAF3E0>]}
[0m18:04:48.202899 [info ] [MainThread]: Found 3 models, 3 data tests, 1 source, 438 macros
[0m18:04:48.203360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd40da9e3-9213-4704-93f0-49649d2cd008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E72A2A4E50>]}
[0m18:04:48.205014 [info ] [MainThread]: 
[0m18:04:48.205495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:48.205939 [info ] [MainThread]: 
[0m18:04:48.206480 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:04:48.209895 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m18:04:48.271419 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m18:04:48.271777 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m18:04:48.272045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:48.320512 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m18:04:48.321765 [debug] [ThreadPool]: On list_krisha_data: Close
[0m18:04:48.323391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m18:04:48.328070 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m18:04:48.328423 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m18:04:48.328686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:48.489013 [debug] [ThreadPool]: SQL status: BEGIN in 0.160 seconds
[0m18:04:48.489445 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m18:04:48.489763 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:04:48.496260 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m18:04:48.497481 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m18:04:48.497965 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m18:04:48.502684 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:48.503027 [debug] [MainThread]: On master: BEGIN
[0m18:04:48.503287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:48.546965 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m18:04:48.547318 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:48.547645 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:04:48.554980 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m18:04:48.556142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd40da9e3-9213-4704-93f0-49649d2cd008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E72A1FFAD0>]}
[0m18:04:48.556534 [debug] [MainThread]: On master: ROLLBACK
[0m18:04:48.557155 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:48.557448 [debug] [MainThread]: On master: BEGIN
[0m18:04:48.557936 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:04:48.558208 [debug] [MainThread]: On master: COMMIT
[0m18:04:48.558465 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:48.558719 [debug] [MainThread]: On master: COMMIT
[0m18:04:48.559049 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:04:48.559316 [debug] [MainThread]: On master: Close
[0m18:04:48.562438 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.raw_data
[0m18:04:48.562945 [info ] [Thread-1 (]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m18:04:48.563553 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m18:04:48.563994 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.raw_data
[0m18:04:48.570341 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m18:04:48.571433 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.raw_data
[0m18:04:48.604067 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m18:04:48.605070 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:04:48.605426 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m18:04:48.605735 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:04:48.648007 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m18:04:48.648407 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:04:48.648719 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m18:04:48.657009 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.008 seconds
[0m18:04:48.665629 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:04:48.666018 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data" rename to "raw_data__dbt_backup"
[0m18:04:48.666755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:04:48.669028 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:04:48.669356 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m18:04:48.670320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:04:48.687005 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m18:04:48.687397 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:04:48.687694 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m18:04:48.690452 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:04:48.695698 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m18:04:48.700046 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:04:48.700406 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m18:04:48.704158 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:04:48.706313 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: Close
[0m18:04:48.708172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40da9e3-9213-4704-93f0-49649d2cd008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E72A690710>]}
[0m18:04:48.708956 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.14s]
[0m18:04:48.709976 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.raw_data
[0m18:04:48.710407 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.transform_data
[0m18:04:48.710825 [info ] [Thread-1 (]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m18:04:48.711573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m18:04:48.711893 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.transform_data
[0m18:04:48.774218 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m18:04:48.775352 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.transform_data
[0m18:04:48.778733 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m18:04:48.779851 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:04:48.780315 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m18:04:48.780720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:48.829102 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m18:04:48.829492 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:04:48.829834 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

with raw as (
    select *
    from "krisha_data"."public"."raw_flats"
    where price > 0
)

select
    row_number() over () as id,
    
    round(cast(price as numeric), -3)
 as rounded_price,
    city as address,  -- Заменил 'address' на 'city'
    
    case
        when lower(city) like '%дом%' then 'house'
        when lower(city) like '%квартира%' then 'flat'
        else 'unknown'
end
 as property_type,  -- Здесь исправил: передаю 'city', а не 'address'
    date as standardized_date,  -- Просто оставляем как есть, без обработки
    sqm as area,  -- Заменил 'area' на 'sqm'
    rooms
from raw
  );
  
[0m18:04:48.838757 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.009 seconds
[0m18:04:48.841517 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:04:48.841875 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public"."transform_data" rename to "transform_data__dbt_backup"
[0m18:04:48.842574 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:04:48.844686 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:04:48.845004 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public"."transform_data__dbt_tmp" rename to "transform_data"
[0m18:04:48.845770 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:04:48.846941 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m18:04:48.847277 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:04:48.847590 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m18:04:48.850147 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:04:48.852164 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."transform_data__dbt_backup"
[0m18:04:48.852692 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:04:48.853013 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
drop table if exists "krisha_data"."public"."transform_data__dbt_backup" cascade
[0m18:04:48.856970 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:04:48.858268 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: Close
[0m18:04:48.858842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40da9e3-9213-4704-93f0-49649d2cd008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E72A226F10>]}
[0m18:04:48.859426 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.transform_data ........................ [[32mSELECT 103[0m in 0.15s]
[0m18:04:48.860166 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.transform_data
[0m18:04:48.861041 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.final_model
[0m18:04:48.861516 [info ] [Thread-1 (]: 3 of 3 START sql table model public.final_model ................................ [RUN]
[0m18:04:48.862325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.transform_data, now model.krisha_data_pipeline.final_model)
[0m18:04:48.862667 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.final_model
[0m18:04:48.865082 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.final_model"
[0m18:04:48.865840 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.final_model
[0m18:04:48.868106 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.final_model"
[0m18:04:48.868918 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:04:48.869502 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: BEGIN
[0m18:04:48.869833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:48.912994 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m18:04:48.913383 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:04:48.913699 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */

  
    

  create  table "krisha_data"."public"."final_model__dbt_tmp"
  
  
    as
  
  (
    -- models/final_model.sql

select
    id,
    rounded_price,
    property_type,
    address,
    standardized_date,
    area,
    rooms
from "krisha_data"."public"."transform_data"
where rounded_price is not null
  and property_type is not null
  and address is not null
  and standardized_date is not null
  and area is not null
  and rooms is not null
  );
  
[0m18:04:48.922479 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.008 seconds
[0m18:04:48.924927 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:04:48.925269 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
alter table "krisha_data"."public"."final_model" rename to "final_model__dbt_backup"
[0m18:04:48.925908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:04:48.928321 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:04:48.928639 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
alter table "krisha_data"."public"."final_model__dbt_tmp" rename to "final_model"
[0m18:04:48.929297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:04:48.930440 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: COMMIT
[0m18:04:48.930778 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:04:48.931089 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: COMMIT
[0m18:04:48.932949 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:04:48.934769 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."final_model__dbt_backup"
[0m18:04:48.935258 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:04:48.935567 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
drop table if exists "krisha_data"."public"."final_model__dbt_backup" cascade
[0m18:04:48.939886 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:04:48.941177 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: Close
[0m18:04:48.941745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd40da9e3-9213-4704-93f0-49649d2cd008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E72A0EB2F0>]}
[0m18:04:48.942319 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.final_model ........................... [[32mSELECT 103[0m in 0.08s]
[0m18:04:48.943057 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.final_model
[0m18:04:48.944269 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:48.944613 [debug] [MainThread]: On master: BEGIN
[0m18:04:48.944881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:48.989426 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m18:04:48.989788 [debug] [MainThread]: On master: COMMIT
[0m18:04:48.990063 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:48.990319 [debug] [MainThread]: On master: COMMIT
[0m18:04:48.990760 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:04:48.991047 [debug] [MainThread]: On master: Close
[0m18:04:48.991472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:48.991726 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m18:04:48.992028 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m18:04:48.992265 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.final_model' was properly closed.
[0m18:04:48.992598 [info ] [MainThread]: 
[0m18:04:48.993092 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m18:04:48.994199 [debug] [MainThread]: Command end result
[0m18:04:49.012702 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m18:04:49.014512 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m18:04:49.020045 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\run_results.json
[0m18:04:49.020473 [info ] [MainThread]: 
[0m18:04:49.020996 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:49.021539 [info ] [MainThread]: 
[0m18:04:49.022500 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:04:49.023642 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:49.023510 after 1.85 seconds
[0m18:04:49.023980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E72A2DD1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E729D8CA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E72898B9A0>]}
[0m18:04:49.024305 [debug] [MainThread]: Flushing usage events
[0m18:04:49.805240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:16.467139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E5BAE3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E384A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E6B13ED0>]}


============================== 18:09:16.473975 | bc825d75-4b02-4be0-aad8-de3b7e6b6130 ==============================
[0m18:09:16.473975 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:09:16.474754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline\\logs', 'profiles_dir': 'C:\\Users\\Dimash\\IdeaProjects\\untitled\\krisha_data_pipeline', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:09:16.662513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc825d75-4b02-4be0-aad8-de3b7e6b6130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E6CC2D70>]}
[0m18:09:16.719599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc825d75-4b02-4be0-aad8-de3b7e6b6130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E6A03020>]}
[0m18:09:16.720513 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:09:16.962306 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:09:17.189827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:09:17.190525 [debug] [MainThread]: Partial parsing: updated file: krisha_data_pipeline://models\final_model.sql
[0m18:09:17.505389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc825d75-4b02-4be0-aad8-de3b7e6b6130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E7EC7A50>]}
[0m18:09:17.573885 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m18:09:17.587304 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m18:09:17.611227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc825d75-4b02-4be0-aad8-de3b7e6b6130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E6B4F3E0>]}
[0m18:09:17.611735 [info ] [MainThread]: Found 3 models, 3 data tests, 1 source, 438 macros
[0m18:09:17.612365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc825d75-4b02-4be0-aad8-de3b7e6b6130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E82A4E50>]}
[0m18:09:17.614651 [info ] [MainThread]: 
[0m18:09:17.615020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:17.615327 [info ] [MainThread]: 
[0m18:09:17.615812 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:09:17.619365 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data'
[0m18:09:17.690672 [debug] [ThreadPool]: Using postgres connection "list_krisha_data"
[0m18:09:17.691028 [debug] [ThreadPool]: On list_krisha_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data"} */

    select distinct nspname from pg_namespace
  
[0m18:09:17.691317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:17.779671 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.088 seconds
[0m18:09:17.780952 [debug] [ThreadPool]: On list_krisha_data: Close
[0m18:09:17.782454 [debug] [ThreadPool]: Acquiring new postgres connection 'list_krisha_data_public'
[0m18:09:17.787305 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m18:09:17.787667 [debug] [ThreadPool]: On list_krisha_data_public: BEGIN
[0m18:09:17.787937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:17.835311 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m18:09:17.835683 [debug] [ThreadPool]: Using postgres connection "list_krisha_data_public"
[0m18:09:17.835968 [debug] [ThreadPool]: On list_krisha_data_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "list_krisha_data_public"} */
select
      'krisha_data' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'krisha_data' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:09:17.850128 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m18:09:17.851368 [debug] [ThreadPool]: On list_krisha_data_public: ROLLBACK
[0m18:09:17.852016 [debug] [ThreadPool]: On list_krisha_data_public: Close
[0m18:09:17.856910 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:17.857244 [debug] [MainThread]: On master: BEGIN
[0m18:09:17.857493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:17.900933 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m18:09:17.901281 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:17.901697 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:09:17.915057 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m18:09:17.916277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc825d75-4b02-4be0-aad8-de3b7e6b6130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E81FFAD0>]}
[0m18:09:17.916660 [debug] [MainThread]: On master: ROLLBACK
[0m18:09:17.917069 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:17.917416 [debug] [MainThread]: On master: BEGIN
[0m18:09:17.917926 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:09:17.918190 [debug] [MainThread]: On master: COMMIT
[0m18:09:17.918443 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:17.918685 [debug] [MainThread]: On master: COMMIT
[0m18:09:17.919023 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:09:17.919286 [debug] [MainThread]: On master: Close
[0m18:09:17.924099 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.raw_data
[0m18:09:17.924591 [info ] [Thread-1 (]: 1 of 3 START sql table model public.raw_data ................................... [RUN]
[0m18:09:17.925148 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.krisha_data_pipeline.raw_data'
[0m18:09:17.925466 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.raw_data
[0m18:09:17.931935 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.raw_data"
[0m18:09:17.932966 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.raw_data
[0m18:09:17.965845 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.raw_data"
[0m18:09:17.966844 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:09:17.967179 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: BEGIN
[0m18:09:17.967476 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:09:18.010834 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m18:09:18.011234 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:09:18.011549 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */

  
    

  create  table "krisha_data"."public"."raw_data__dbt_tmp"
  
  
    as
  
  (
    -- models/raw_data.sql

select *
from "krisha_data"."public"."raw_flats"
where price is not null
  );
  
[0m18:09:18.031945 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.020 seconds
[0m18:09:18.039981 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:09:18.040385 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data" rename to "raw_data__dbt_backup"
[0m18:09:18.041950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:09:18.044231 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:09:18.044554 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
alter table "krisha_data"."public"."raw_data__dbt_tmp" rename to "raw_data"
[0m18:09:18.045201 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:09:18.062008 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m18:09:18.062430 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:09:18.062759 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: COMMIT
[0m18:09:18.065642 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:09:18.070947 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."raw_data__dbt_backup"
[0m18:09:18.075241 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.raw_data"
[0m18:09:18.075593 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.raw_data"} */
drop table if exists "krisha_data"."public"."raw_data__dbt_backup" cascade
[0m18:09:18.085447 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m18:09:18.087753 [debug] [Thread-1 (]: On model.krisha_data_pipeline.raw_data: Close
[0m18:09:18.089617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc825d75-4b02-4be0-aad8-de3b7e6b6130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E869C710>]}
[0m18:09:18.090294 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.raw_data .............................. [[32mSELECT 103[0m in 0.16s]
[0m18:09:18.091031 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.raw_data
[0m18:09:18.091416 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.transform_data
[0m18:09:18.091953 [info ] [Thread-1 (]: 2 of 3 START sql table model public.transform_data ............................. [RUN]
[0m18:09:18.092472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.raw_data, now model.krisha_data_pipeline.transform_data)
[0m18:09:18.092798 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.transform_data
[0m18:09:18.162855 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.transform_data"
[0m18:09:18.164244 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.transform_data
[0m18:09:18.167353 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.transform_data"
[0m18:09:18.168508 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:09:18.168917 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: BEGIN
[0m18:09:18.169277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:18.215980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m18:09:18.216372 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:09:18.216704 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */

  
    

  create  table "krisha_data"."public"."transform_data__dbt_tmp"
  
  
    as
  
  (
    -- models/transform_data.sql

with raw as (
    select *
    from "krisha_data"."public"."raw_flats"
    where price > 0
)

select
    row_number() over () as id,
    
    round(cast(price as numeric), -3)
 as rounded_price,
    city as address,  -- Заменил 'address' на 'city'
    
    case
        when lower(city) like '%дом%' then 'house'
        when lower(city) like '%квартира%' then 'flat'
        else 'unknown'
end
 as property_type,  -- Здесь исправил: передаю 'city', а не 'address'
    date as standardized_date,  -- Просто оставляем как есть, без обработки
    sqm as area,  -- Заменил 'area' на 'sqm'
    rooms
from raw
  );
  
[0m18:09:18.234057 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.017 seconds
[0m18:09:18.236942 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:09:18.237290 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public"."transform_data" rename to "transform_data__dbt_backup"
[0m18:09:18.238239 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:09:18.240319 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:09:18.240645 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
alter table "krisha_data"."public"."transform_data__dbt_tmp" rename to "transform_data"
[0m18:09:18.241444 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:09:18.242728 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m18:09:18.243106 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:09:18.243427 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: COMMIT
[0m18:09:18.245300 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:09:18.247119 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."transform_data__dbt_backup"
[0m18:09:18.247625 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.transform_data"
[0m18:09:18.247942 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.transform_data"} */
drop table if exists "krisha_data"."public"."transform_data__dbt_backup" cascade
[0m18:09:18.252171 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:09:18.253459 [debug] [Thread-1 (]: On model.krisha_data_pipeline.transform_data: Close
[0m18:09:18.254038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc825d75-4b02-4be0-aad8-de3b7e6b6130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E8233750>]}
[0m18:09:18.254628 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.transform_data ........................ [[32mSELECT 103[0m in 0.16s]
[0m18:09:18.255584 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.transform_data
[0m18:09:18.256280 [debug] [Thread-1 (]: Began running node model.krisha_data_pipeline.final_model
[0m18:09:18.256829 [info ] [Thread-1 (]: 3 of 3 START sql table model public.final_model ................................ [RUN]
[0m18:09:18.257614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.krisha_data_pipeline.transform_data, now model.krisha_data_pipeline.final_model)
[0m18:09:18.258032 [debug] [Thread-1 (]: Began compiling node model.krisha_data_pipeline.final_model
[0m18:09:18.260527 [debug] [Thread-1 (]: Writing injected SQL for node "model.krisha_data_pipeline.final_model"
[0m18:09:18.261368 [debug] [Thread-1 (]: Began executing node model.krisha_data_pipeline.final_model
[0m18:09:18.263717 [debug] [Thread-1 (]: Writing runtime sql for node "model.krisha_data_pipeline.final_model"
[0m18:09:18.264673 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:09:18.265071 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: BEGIN
[0m18:09:18.265372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:18.309944 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m18:09:18.310334 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:09:18.310707 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */

  
    

  create  table "krisha_data"."public"."final_model__dbt_tmp"
  
  
    as
  
  (
    -- models/final_model.sql

select
    id,
    rounded_price,
    address,
    standardized_date,
    area,
    rooms
from "krisha_data"."public"."transform_data"
where rounded_price is not null
  and address is not null
  and standardized_date is not null
  and area is not null
  and rooms is not null
  );
  
[0m18:09:18.319752 [debug] [Thread-1 (]: SQL status: SELECT 103 in 0.009 seconds
[0m18:09:18.322962 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:09:18.323327 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
alter table "krisha_data"."public"."final_model" rename to "final_model__dbt_backup"
[0m18:09:18.323980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:09:18.326509 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:09:18.326878 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
alter table "krisha_data"."public"."final_model__dbt_tmp" rename to "final_model"
[0m18:09:18.327585 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:09:18.328793 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: COMMIT
[0m18:09:18.329132 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:09:18.329445 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: COMMIT
[0m18:09:18.331082 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:09:18.332867 [debug] [Thread-1 (]: Applying DROP to: "krisha_data"."public"."final_model__dbt_backup"
[0m18:09:18.333359 [debug] [Thread-1 (]: Using postgres connection "model.krisha_data_pipeline.final_model"
[0m18:09:18.333688 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "krisha_profile", "target_name": "dev", "node_id": "model.krisha_data_pipeline.final_model"} */
drop table if exists "krisha_data"."public"."final_model__dbt_backup" cascade
[0m18:09:18.338296 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:09:18.339613 [debug] [Thread-1 (]: On model.krisha_data_pipeline.final_model: Close
[0m18:09:18.340176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc825d75-4b02-4be0-aad8-de3b7e6b6130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E8592350>]}
[0m18:09:18.340758 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.final_model ........................... [[32mSELECT 103[0m in 0.08s]
[0m18:09:18.341445 [debug] [Thread-1 (]: Finished running node model.krisha_data_pipeline.final_model
[0m18:09:18.342737 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:18.343067 [debug] [MainThread]: On master: BEGIN
[0m18:09:18.343330 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:18.387809 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m18:09:18.388170 [debug] [MainThread]: On master: COMMIT
[0m18:09:18.388447 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:18.388708 [debug] [MainThread]: On master: COMMIT
[0m18:09:18.389089 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:09:18.389365 [debug] [MainThread]: On master: Close
[0m18:09:18.389780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:18.390036 [debug] [MainThread]: Connection 'list_krisha_data' was properly closed.
[0m18:09:18.390310 [debug] [MainThread]: Connection 'list_krisha_data_public' was properly closed.
[0m18:09:18.390548 [debug] [MainThread]: Connection 'model.krisha_data_pipeline.final_model' was properly closed.
[0m18:09:18.391280 [info ] [MainThread]: 
[0m18:09:18.391772 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m18:09:18.392864 [debug] [MainThread]: Command end result
[0m18:09:18.409351 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\manifest.json
[0m18:09:18.411171 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\semantic_manifest.json
[0m18:09:18.417398 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Dimash\IdeaProjects\untitled\krisha_data_pipeline\target\run_results.json
[0m18:09:18.417733 [info ] [MainThread]: 
[0m18:09:18.418238 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:18.418677 [info ] [MainThread]: 
[0m18:09:18.419118 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:09:18.419872 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:18.419763 after 2.16 seconds
[0m18:09:18.420194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E82DD1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E6DBCA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E6A2F9A0>]}
[0m18:09:18.420514 [debug] [MainThread]: Flushing usage events
[0m18:09:19.364919 [debug] [MainThread]: An error was encountered while trying to flush usage events
